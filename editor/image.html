<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Table Detection</title>
    <style>
      table {
        border-collapse: collapse;
      }

      table,
      th,
      td {
        border: 1px solid black;
        padding: 8px;
      }

      table:hover {
        border: 2px solid red;
        cursor: pointer;
      }
      .popover {
        display: none;
        position: absolute;
        background-color: white;
        border: 1px solid black;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div id="tableContainer"></div>
    <div class="popover" id="popover">Popover Content</div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        function addRowBelow(rowIdx) {
          var table = document.querySelector("table");
          var newRow = table.insertRow(rowIdx + 1); // Inserts a row below the specified row index
          var numCols = table.rows[0].cells.length; // Get the number of columns
          for (var i = 0; i < numCols; i++) {
            var cell = newRow.insertCell();
            cell.textContent = "New Row, Col " + (i + 1);
          }
        }

        function addRowAbove(rowIdx) {
          var table = document.querySelector("table");
          var newRow = table.insertRow(rowIdx); // Inserts a row above the specified row index
          var numCols = table.rows[0].cells.length; // Get the number of columns
          for (var i = 0; i < numCols; i++) {
            var cell = newRow.insertCell();
            cell.textContent = "New Row, Col " + (i + 1);
          }
        }

        function addColumnRight(colIdx) {
          var table = document.querySelector("table");
          var numRows = table.rows.length;
          for (var i = 0; i < numRows; i++) {
            var cell = table.rows[i].insertCell(colIdx + 1); // Inserts a cell to the right of the specified column index in each row
            cell.textContent = "New Row " + (i + 1) + ", New Col";
          }
        }

        function addColumnLeft(colIdx) {
          var table = document.querySelector("table");
          var numRows = table.rows.length;
          for (var i = 0; i < numRows; i++) {
            var cell = table.rows[i].insertCell(colIdx); // Inserts a cell to the left of the specified column index in each row
            cell.textContent = "New Row " + (i + 1) + ", New Col";
          }
        }
        function createTable(m, n) {
          // Create a new table element
          var table = document.createElement("table");

          // Create rows and cells
          for (var i = 0; i < m; i++) {
            var row = table.insertRow();
            for (var j = 0; j < n; j++) {
              var cell = row.insertCell();
              // Add some content to the cells (optional)
              cell.textContent = "Row " + (i + 1) + ", Col " + (j + 1);
            }
          }

          // Append the table to the container
          document.getElementById("tableContainer").appendChild(table);
        }

        // Call the function with desired number of rows and columns
        createTable(5, 3);
        const tables = document.querySelectorAll("table");
        const popover = document.getElementById("popover");
        tables.forEach((table) => {
          table.addEventListener("mouseenter", function () {
            // Show popover on hover
            popover.style.display = "block";
            popover.style.left = `${table.getBoundingClientRect().left}px`;
            popover.style.top = `${table.getBoundingClientRect().bottom}px`;
          });
          table.addEventListener("click", function (event) {
            // Prevent the click event from propagating to document
            event.stopPropagation();
            // Toggle popover on click

            popover.style.display = "block";
            popover.style.left = `${table.getBoundingClientRect().left}px`;
            popover.style.top = `${table.getBoundingClientRect().bottom}px`;
          });
        });

        // Add event listener to close popover on click
        popover.addEventListener("click", function (event) {
          console.log("s");
          event.stopPropagation(); // Prevent the event from propagating to document
        });

        // Hide popover when clicking outside the popover or table
        document.addEventListener("click", function () {
          popover.style.display = "none";
        });
      });
    </script>
  </body>
</html>
