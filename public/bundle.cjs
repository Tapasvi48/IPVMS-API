/*! For license information please see bundle.cjs.LICENSE.txt */
(()=>{"use strict";(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})({});const t=require("express"),e=require("body-parser"),r=require("cors"),n=require("dotenv"),o=require("path");var a=new(0,require("pg").Pool)({user:"root",password:"xsRLlDQJnsniVeJTF1MUDbUCZxyXSQQl",host:"dpg-co2h7bgl6cac73bnjcpg-a.singapore-postgres.render.com",port:5432,database:"ipvms",ssl:!0,log_directory:"pg_log",log_filename:"postgresql-dateformat.log",log_statement:"all"});a.connect((function(t,e,r){if(t)return console.error("Error acquiring client",t.stack);e.query("SELECT NOW()",(function(t,e){if(r(),t)throw console.error("Error executing query",t.stack),t;console.log("Connected to Database !")}))})),a.on("error",(function(t,e){t&&(console.log("error from client",t),process.exit(-1))}));const i=require("bcryptjs"),c=require("jsonwebtoken"),s=require("nodemailer");var u=function(){return"<div>\n    <h1>This letter is for signing </h1>\n\n    </div>"};function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function f(t,e,r){return e&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e,r){return e=w(e),function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,r||[],w(t).constructor):e.apply(t,r))}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function v(t){var e="function"==typeof Map?new Map:void 0;return v=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(g())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&b(o,r.prototype),o}(t,arguments,w(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,t)},v(t)}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}var x=function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t||"Internal Server error happened"])).name="Database Error",r.statusCode=500,r.success=!1,r}return m(e,t),f(e)}(v(Error)),E=function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t||"Invalid Credentials here"])).name="Validation Error",r.error=t,r.statusCode=400,r.success=!1,r}return m(e,t),f(e)}(v(Error)),L=function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t||"Data was not found"])).name="Not Found Error",r.statusCode=404,r.error=t,r.success=!1,r}return m(e,t),f(e)}(v(Error)),_=function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t||"User is not Authorized to access the resource"])).name="Authorization Error",r.statusCode=401,r.error=t,r.success=!1,r}return m(e,t),f(e)}(v(Error)),j=function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t||"Resource Already Exists"])).name="Conflict Error",r.statusCode=409,r.error=t,r.success=!1,r}return m(e,t),f(e)}(v(Error)),k=function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t||""])).name="Invalid",r.statusCode=498,r.error=t,r.success=!1,r}return m(e,t),f(e)}(v(Error)),A=(Error,function(t){function e(t){var r;return d(this,e),(r=y(this,e,[t])).name="Bad Gateway",r.statusCode=403,r.error=t,r.success=!1,r}return m(e,t),f(e)}(v(Error))),S=function(t){function e(t,r){var n;return d(this,e),(n=y(this,e,["".concat(t,":").concat(r)])).name="User account is not setup",n.statusCode=318,n.error=t,n.success=!0,n}return m(e,t),f(e)}(v(Error)),O=function(t,e,r){return'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n    <html xmlns="http://www.w3.org/1999/xhtml">\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n        <meta name="x-apple-disable-message-reformatting" />\n        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n        <meta name="color-scheme" content="light dark" />\n        <meta name="supported-color-schemes" content="light dark" />\n        <title></title>\n        <style type="text/css" rel="stylesheet" media="all">\n        /* Base ------------------------------ */\n        \n        @import url("https://fonts.googleapis.com/css?family=Nunito+Sans:400,700&display=swap");\n        body {\n          width: 100% !important;\n          height: 100%;\n          margin: 0;\n          -webkit-text-size-adjust: none;\n        }\n        \n        a {\n          color: #3869D4;\n        }\n        \n        a img {\n          border: none;\n        }\n        \n        td {\n          word-break: break-word;\n        }\n        \n        .preheader {\n          display: none !important;\n          visibility: hidden;\n          mso-hide: all;\n          font-size: 1px;\n          line-height: 1px;\n          max-height: 0;\n          max-width: 0;\n          opacity: 0;\n          overflow: hidden;\n        }\n        /* Type ------------------------------ */\n        \n        body,\n        td,\n        th {\n          font-family: "Nunito Sans", Helvetica, Arial, sans-serif;\n        }\n        \n        h1 {\n          margin-top: 0;\n          color: #333333;\n          font-size: 22px;\n          font-weight: bold;\n          text-align: left;\n        }\n        \n        h2 {\n          margin-top: 0;\n          color: #333333;\n          font-size: 16px;\n          font-weight: bold;\n          text-align: left;\n        }\n        \n        h3 {\n          margin-top: 0;\n          color: #333333;\n          font-size: 14px;\n          font-weight: bold;\n          text-align: left;\n        }\n        \n        td,\n        th {\n          font-size: 16px;\n        }\n        \n        p,\n        ul,\n        ol,\n        blockquote {\n          margin: .4em 0 1.1875em;\n          font-size: 16px;\n          line-height: 1.625;\n        }\n        \n        p.sub {\n          font-size: 13px;\n        }\n        /* Utilities ------------------------------ */\n        \n        .align-right {\n          text-align: right;\n        }\n        \n        .align-left {\n          text-align: left;\n        }\n        \n        .align-center {\n          text-align: center;\n        }\n        \n        .u-margin-bottom-none {\n          margin-bottom: 0;\n        }\n        /* Buttons ------------------------------ */\n        \n        .button {\n          background-color: #3869D4;\n          border-top: 10px solid #3869D4;\n          border-right: 18px solid #3869D4;\n          border-bottom: 10px solid #3869D4;\n          border-left: 18px solid #3869D4;\n          display: inline-block;\n          color: #FFF;\n          text-decoration: none;\n          border-radius: 3px;\n          box-shadow: 0 2px 3px rgba(0, 0, 0, 0.16);\n          -webkit-text-size-adjust: none;\n          box-sizing: border-box;\n        }\n        \n        .button--green {\n          background-color: #22BC66;\n          border-top: 10px solid #22BC66;\n          border-right: 18px solid #22BC66;\n          border-bottom: 10px solid #22BC66;\n          border-left: 18px solid #22BC66;\n        }\n        \n        .button--red {\n          background-color: #FF6136;\n          border-top: 10px solid #FF6136;\n          border-right: 18px solid #FF6136;\n          border-bottom: 10px solid #FF6136;\n          border-left: 18px solid #FF6136;\n        }\n        \n        @media only screen and (max-width: 500px) {\n          .button {\n            width: 100% !important;\n            text-align: center !important;\n          }\n        }\n        /* Attribute list ------------------------------ */\n        \n        .attributes {\n          margin: 0 0 21px;\n        }\n        \n        .attributes_content {\n          background-color: #F4F4F7;\n          padding: 16px;\n        }\n        \n        .attributes_item {\n          padding: 0;\n        }\n        /* Related Items ------------------------------ */\n        \n        .related {\n          width: 100%;\n          margin: 0;\n          padding: 25px 0 0 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n        }\n        \n        .related_item {\n          padding: 10px 0;\n          color: #CBCCCF;\n          font-size: 15px;\n          line-height: 18px;\n        }\n        \n        .related_item-title {\n          display: block;\n          margin: .5em 0 0;\n        }\n        \n        .related_item-thumb {\n          display: block;\n          padding-bottom: 10px;\n        }\n        \n        .related_heading {\n          border-top: 1px solid #CBCCCF;\n          text-align: center;\n          padding: 25px 0 10px;\n        }\n        /* Discount Code ------------------------------ */\n        \n        .discount {\n          width: 100%;\n          margin: 0;\n          padding: 24px;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n          background-color: #F4F4F7;\n          border: 2px dashed #CBCCCF;\n        }\n        \n        .discount_heading {\n          text-align: center;\n        }\n        \n        .discount_body {\n          text-align: center;\n          font-size: 15px;\n        }\n        /* Social Icons ------------------------------ */\n        \n        .social {\n          width: auto;\n        }\n        \n        .social td {\n          padding: 0;\n          width: auto;\n        }\n        \n        .social_icon {\n          height: 20px;\n          margin: 0 8px 10px 8px;\n          padding: 0;\n        }\n        /* Data table ------------------------------ */\n        \n        .purchase {\n          width: 100%;\n          margin: 0;\n          padding: 35px 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n        }\n        \n        .purchase_content {\n          width: 100%;\n          margin: 0;\n          padding: 25px 0 0 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n        }\n        \n        .purchase_item {\n          padding: 10px 0;\n          color: #51545E;\n          font-size: 15px;\n          line-height: 18px;\n        }\n        \n        .purchase_heading {\n          padding-bottom: 8px;\n          border-bottom: 1px solid #EAEAEC;\n        }\n        \n        .purchase_heading p {\n          margin: 0;\n          color: #85878E;\n          font-size: 12px;\n        }\n        \n        .purchase_footer {\n          padding-top: 15px;\n          border-top: 1px solid #EAEAEC;\n        }\n        \n        .purchase_total {\n          margin: 0;\n          text-align: right;\n          font-weight: bold;\n          color: #333333;\n        }\n        \n        .purchase_total--label {\n          padding: 0 15px 0 0;\n        }\n        \n        body {\n          background-color: #F2F4F6;\n          color: #51545E;\n        }\n        \n        p {\n          color: #51545E;\n        }\n        \n        .email-wrapper {\n          width: 100%;\n          margin: 0;\n          padding: 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n          background-color: #F2F4F6;\n        }\n        \n        .email-content {\n          width: 100%;\n          margin: 0;\n          padding: 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n        }\n        /* Masthead ----------------------- */\n        \n        .email-masthead {\n          padding: 25px 0;\n          text-align: center;\n        }\n        \n        .email-masthead_logo {\n          width: 94px;\n        }\n        \n        .email-masthead_name {\n          font-size: 16px;\n          font-weight: bold;\n          color: #A8AAAF;\n          text-decoration: none;\n          text-shadow: 0 1px 0 white;\n        }\n        /* Body ------------------------------ */\n        \n        .email-body {\n          width: 100%;\n          margin: 0;\n          padding: 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n        }\n        \n        .email-body_inner {\n          width: 570px;\n          margin: 0 auto;\n          padding: 0;\n          -premailer-width: 570px;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n          background-color: #FFFFFF;\n        }\n        \n        .email-footer {\n          width: 570px;\n          margin: 0 auto;\n          padding: 0;\n          -premailer-width: 570px;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n          text-align: center;\n        }\n        \n        .email-footer p {\n          color: #A8AAAF;\n        }\n        \n        .body-action {\n          width: 100%;\n          margin: 30px auto;\n          padding: 0;\n          -premailer-width: 100%;\n          -premailer-cellpadding: 0;\n          -premailer-cellspacing: 0;\n          text-align: center;\n        }\n        \n        .body-sub {\n          margin-top: 25px;\n          padding-top: 25px;\n          border-top: 1px solid #EAEAEC;\n        }\n        \n        .content-cell {\n          padding: 45px;\n        }\n        /*Media Queries ------------------------------ */\n        \n        @media only screen and (max-width: 600px) {\n          .email-body_inner,\n          .email-footer {\n            width: 100% !important;\n          }\n        }\n        \n        @media (prefers-color-scheme: dark) {\n          body,\n          .email-body,\n          .email-body_inner,\n          .email-content,\n          .email-wrapper,\n          .email-masthead,\n          .email-footer {\n            background-color: #333333 !important;\n            color: #FFF !important;\n          }\n          p,\n          ul,\n          ol,\n          blockquote,\n          h1,\n          h2,\n          h3,\n          span,\n          .purchase_item {\n            color: #FFF !important;\n          }\n          .attributes_content,\n          .discount {\n            background-color: #222 !important;\n          }\n          .email-masthead_name {\n            text-shadow: none !important;\n          }\n        }\n        \n        :root {\n          color-scheme: light dark;\n          supported-color-schemes: light dark;\n        }\n        </style>\n        \x3c!--[if mso]>\n        <style type="text/css">\n          .f-fallback  {\n            font-family: Arial, sans-serif;\n          }\n        </style>\n      <![endif]--\x3e\n      </head>\n      <body>\n        <span class="preheader">ex2 india has invited you to use ipvms</span>\n        <table class="email-wrapper" width="100%" cellpadding="0" cellspacing="0" role="presentation">\n          <tr>\n            <td align="center">\n              <table class="email-content" width="100%" cellpadding="0" cellspacing="0" role="presentation">\n                <tr>\n                  <td class="email-masthead">\n                    <a href="https://example.com" class="f-fallback email-masthead_name">\n                    IPVMS\n                  </a>\n                  </td>\n                </tr>\n                \x3c!-- Email Body --\x3e\n                <tr>\n                  <td class="email-body" width="570" cellpadding="0" cellspacing="0">\n                    <table class="email-body_inner" align="center" width="570" cellpadding="0" cellspacing="0" role="presentation">\n                      \x3c!-- Body content --\x3e\n                      <tr>\n                        <td class="content-cell">\n                          <div class="f-fallback">\n                            <h1>Hi, '.concat(t,"!</h1>\n                            <p>ex2 india has invited you to use ipvms</p>\n                            <div>\n                            Your credentials are\n                            <p>email:").concat(t,"</p>\n                            <p>password:").concat(e,'</p>\n                            </div>\n                            \x3c!-- Action --\x3e\n                            <table class="body-action" align="center" width="100%" cellpadding="0" cellspacing="0" role="presentation">\n                              <tr>\n                                <td align="center">\n                                  \x3c!-- Border based button\n               https://litmus.com/blog/a-guide-to-bulletproof-buttons-in-email-design --\x3e\n                                  <table width="100%" border="0" cellspacing="0" cellpadding="0" role="presentation">\n                                    <tr>\n                                      <td align="center">\n                                        <a href="').concat(r,'" class="f-fallback button" target="_blank">Set up account</a>\n                                      </td>\n                                    </tr>\n                                    <br></br>\n                                  </table>\n                                </td>\n                              </tr>\n                            </table>\n                            <p>If you have any questions for us, you can reply to this email and it will go right to them. Alternatively, feel free to <a href="mailto:{{support_email}}"></a></p> \n                             <p>Welcome aboard,\n                              <br>The ipvms team</br></p>\n                            <p><strong>P.S.</strong> Need help getting started? Check out our <a href="{{help_url}}">help documentation</a>.</p>\n                            \x3c!-- Sub copy --\x3e\n                            <table class="body-sub" role="presentation">\n                              <tr>\n                                <td>\n                                  <p class="f-fallback sub">If youâ€™re having trouble with the button above, copy and paste the URL below into your web browser.</p>\n                                  <p class="f-fallback sub">').concat(r,'</p>\n                                </td>\n                              </tr>\n                            </table>\n                          </div>\n                        </td>\n                      </tr>\n                    </table>\n                  </td>\n                </tr>\n                <tr>\n                  <td>\n                    <table class="email-footer" align="center" width="570" cellpadding="0" cellspacing="0" role="presentation">\n                      <tr>\n                        <td class="content-cell" align="center">\n                          <p class="f-fallback sub align-center">\n                            ex2 india\n                            <br>faridabad.</br>\n                            <br>Haryana</br>\n                          </p>\n                        </td>\n                      </tr>\n                    </table>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n        </table>\n      </body>\n    </html>')};function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(N([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==C(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(C(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function I(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function N(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){I(a,n,o,i,c,"next",t)}function c(t){I(a,n,o,i,c,"throw",t)}i(void 0)}))}}var P=o.resolve();n.config({path:o.resolve(P,"./.env")});var R=function(){var t=N(T().mark((function t(e,r){var n,o;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&r){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,n=s.createTransport({host:process.env.SMTP_HOST,port:process.env.SMTP_PORT,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}}),a="http://localhost:5555/resetpassword?token=".concat(r),i=(new Date).toLocaleDateString(),o='\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" style="min-height:100%;background:#f3f3f3">\n  <head>\n    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\n</head>\n<body style="min-width:50%;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;width:100% !important">\n<div class="preheader" style="visibility:hidden;opacity:0;color:transparent;height:0;width:0;font-size:0px;mso-hide:all;display:none !important"></div>\n    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">\n    <meta name="viewport" content="width=device-width">\n    <style data-roadie-ignore data-immutable="true" type="text/css">\n  /*Light*/\n  @font-face {\n    font-family: \'Cereal\';\n    font-style: normal;\n    font-weight: 200;\n    src: url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Lt-61d38480cfdf1dfc73d6bd0f459b3e10.eot");\n    src: url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Lt-61d38480cfdf1dfc73d6bd0f459b3e10.eot?#") format("eot"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Lt-4f51497e2f6db6e72599a1f2f484eb7e.woff") format("woff"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Lt-919ae0b65de2f8c6204ec57daeceb9e9.woff2") format("woff2"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Lt-ef243dd05072c5987d3abcbe00581224.ttf") format("truetype");\n  }\n\n  /*Regular*/\n  @font-face {\n    font-family: \'Cereal\';\n    font-style: normal;\n    font-weight: 300;\n    src: url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Rg-909a75677f1cbf6e66c8811e6d39441a.eot");\n    src: url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Rg-909a75677f1cbf6e66c8811e6d39441a.eot?#") format("eot"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Rg-391ee76d399e20117aade2ce1f7e196e.woff") format("woff"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Rg-3ff4006ded0500d605d6eff88ccc59f8.woff2") format("woff2"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Rg-190a6e02b3b3d6cfaf3bbe887349adad.ttf") format("truetype");\n  }\n\n  /*Medium*/\n  @font-face {\n    font-family: \'Cereal\';\n    font-style: normal;\n    font-weight: 500;\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Md-ff8747694c95295917ef4c60c2bb6bce.eot");\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Md-ff8747694c95295917ef4c60c2bb6bce.eot?#") format("eot"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Md-b9bb7e6d20007be4b0caa86ea7fbd906.woff") format("woff"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Md-dec1db4a099dd1761f19bbe3088de0c8.woff2") format("woff2"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Md-2f25e87279c9c202ebf384fae79ac376.ttf") format("truetype");\n  }\n\n  /*Bold*/\n  @font-face {\n    font-family: \'Cereal\';\n    font-style: normal;\n    font-weight: 700;\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bd-7b4c5f071be2fb695c04a1af3a1e0616.eot");\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bd-7b4c5f071be2fb695c04a1af3a1e0616.eot?#") format("eot"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bd-20d7bff68cfbfa449bd9601275d29996.woff") format("woff"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bd-32afa6b67d060b665623bbc48ce00187.woff2") format("woff2"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bd-943ebbaff21543f9115cf46427213a47.ttf") format("truetype");\n  }\n\n  /*XBold*/\n  @font-face {\n    font-family: \'Cereal\';\n    font-style: normal;\n    font-weight: 800;\n    src: url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_XBd-170530db17719eb719c2f03f8ac2a94d.eot");\n    src: url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_XBd-170530db17719eb719c2f03f8ac2a94d.eot?#") format("eot"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_XBd-3aea49864b40db534f43dc271460baba.woff") format("woff"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_XBd-66f244ea0cd79026250a9ba89a47a7aa.woff2") format("woff2"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_XBd-5d879965b6ea4ac2a31b41647c283433.ttf") format("truetype");\n  }\n\n  /*Black*/\n  @font-face {\n    font-family: \'Cereal\';\n    font-style: normal;\n    font-weight: 900;\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-5e8fbee9505fc68a77d714aa35aee405.eot");\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-5e8fbee9505fc68a77d714aa35aee405.eot?#") format("eot"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-36f3fbaecfd0e0f82e83f28a466ce425.woff") format("woff"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-eed38b780704d1a3acbdb4ed930f6cdf.woff2") format("woff2"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-a7f958b92f5a7555e9a6d5755e026c6b.ttf") format("truetype");\n  }\n  @font-face {\n    font-family: \'Cereal Black\';\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-5e8fbee9505fc68a77d714aa35aee405.eot");\n    src: url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-5e8fbee9505fc68a77d714aa35aee405.eot?#") format("eot"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-36f3fbaecfd0e0f82e83f28a466ce425.woff") format("woff"),\n      url("https://a1.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-eed38b780704d1a3acbdb4ed930f6cdf.woff2") format("woff2"),\n      url("https://a0.muscache.com/airbnb/rookery/fonts/Cereal/Cereal_W_Bk-a7f958b92f5a7555e9a6d5755e026c6b.ttf") format("truetype");\n  }\n</style>\n\n    \n    \n    \n    <style data-roadie-ignore data-immutable="true">\n      @media only screen and (max-width: 596px) {\n        .small-float-center {\n          margin: 0 auto !important;\n          float: none !important;\n          text-align: center !important; }\n        .small-text-center {\n          text-align: center !important; }\n        .small-text-left {\n          text-align: left !important; }\n        .small-text-right {\n          text-align: right !important; } }\n\n        @media only screen and (max-width: 596px) {\n          table.body table.container .hide-for-large {\n            display: block !important;\n            width: auto !important;\n            overflow: visible !important;\n            max-height: none !important; } }\n\n      @media only screen and (max-width: 596px) {\n        table.body table.container .row.hide-for-large,\n        table.body table.container .row.hide-for-large {\n          display: table !important;\n          width: 100% !important; } }\n\n      @media only screen and (max-width: 596px) {\n        table.body table.container .show-for-large {\n          display: none !important;\n          width: 0;\n          mso-hide: all;\n          overflow: hidden; } }\n\n      @media only screen and (max-width: 596px) {\n        table.body img {\n          width: auto !important;\n          height: auto !important; }\n        table.body center {\n          min-width: 0 !important; }\n        table.body .container {\n          width: 95% !important; }\n        table.body .columns,\n        table.body .column {\n          height: auto !important;\n          -moz-box-sizing: border-box;\n          -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n          padding-left: 16px !important;\n          padding-right: 16px !important; }\n          table.body .columns .column,\n          table.body .columns .columns,\n          table.body .column .column,\n          table.body .column .columns {\n            padding-left: 0 !important;\n            padding-right: 0 !important; }\n          table.body .columns .column.nested,\n          table.body .columns .columns.nested,\n          table.body .column .column.nested,\n          table.body .column .columns.nested {\n            padding-left: 16px !important;\n            padding-right: 16px !important; }\n        table.body .collapse .columns,\n        table.body .collapse .column {\n          padding-left: 0 !important;\n          padding-right: 0 !important; }\n        td.small-1,\n        th.small-1 {\n          display: inline-block !important;\n          width: 8.33333% !important; }\n        td.small-2,\n        th.small-2 {\n          display: inline-block !important;\n          width: 16.66667% !important; }\n        td.small-3,\n        th.small-3 {\n          display: inline-block !important;\n          width: 25% !important; }\n        td.small-4,\n        th.small-4 {\n          display: inline-block !important;\n          width: 33.33333% !important; }\n        td.small-5,\n        th.small-5 {\n          display: inline-block !important;\n          width: 41.66667% !important; }\n        td.small-6,\n        th.small-6 {\n          display: inline-block !important;\n          width: 50% !important; }\n        td.small-7,\n        th.small-7 {\n          display: inline-block !important;\n          width: 58.33333% !important; }\n        td.small-8,\n        th.small-8 {\n          display: inline-block !important;\n          width: 66.66667% !important; }\n        td.small-9,\n        th.small-9 {\n          display: inline-block !important;\n          width: 75% !important; }\n        td.small-10,\n        th.small-10 {\n          display: inline-block !important;\n          width: 83.33333% !important; }\n        td.small-11,\n        th.small-11 {\n          display: inline-block !important;\n          width: 91.66667% !important; }\n        td.small-12,\n        th.small-12 {\n          display: inline-block !important;\n          width: 100% !important; }\n        .columns td.small-12,\n        .column td.small-12,\n        .columns th.small-12,\n        .column th.small-12 {\n          display: block !important;\n          width: 100% !important; }\n        .body .columns td.small-1,\n        .body .column td.small-1,\n        td.small-1 center,\n        .body .columns th.small-1,\n        .body .column th.small-1,\n        th.small-1 center {\n          display: inline-block !important;\n          width: 8.33333% !important; }\n        .body .columns td.small-2,\n        .body .column td.small-2,\n        td.small-2 center,\n        .body .columns th.small-2,\n        .body .column th.small-2,\n        th.small-2 center {\n          display: inline-block !important;\n          width: 16.66667% !important; }\n        .body .columns td.small-3,\n        .body .column td.small-3,\n        td.small-3 center,\n        .body .columns th.small-3,\n        .body .column th.small-3,\n        th.small-3 center {\n          display: inline-block !important;\n          width: 25% !important; }\n        .body .columns td.small-4,\n        .body .column td.small-4,\n        td.small-4 center,\n        .body .columns th.small-4,\n        .body .column th.small-4,\n        th.small-4 center {\n          display: inline-block !important;\n          width: 33.33333% !important; }\n        .body .columns td.small-5,\n        .body .column td.small-5,\n        td.small-5 center,\n        .body .columns th.small-5,\n        .body .column th.small-5,\n        th.small-5 center {\n          display: inline-block !important;\n          width: 41.66667% !important; }\n        .body .columns td.small-6,\n        .body .column td.small-6,\n        td.small-6 center,\n        .body .columns th.small-6,\n        .body .column th.small-6,\n        th.small-6 center {\n          display: inline-block !important;\n          width: 50% !important; }\n        .body .columns td.small-7,\n        .body .column td.small-7,\n        td.small-7 center,\n        .body .columns th.small-7,\n        .body .column th.small-7,\n        th.small-7 center {\n          display: inline-block !important;\n          width: 58.33333% !important; }\n        .body .columns td.small-8,\n        .body .column td.small-8,\n        td.small-8 center,\n        .body .columns th.small-8,\n        .body .column th.small-8,\n        th.small-8 center {\n          display: inline-block !important;\n          width: 66.66667% !important; }\n        .body .columns td.small-9,\n        .body .column td.small-9,\n        td.small-9 center,\n        .body .columns th.small-9,\n        .body .column th.small-9,\n        th.small-9 center {\n          display: inline-block !important;\n          width: 75% !important; }\n        .body .columns td.small-10,\n        .body .column td.small-10,\n        td.small-10 center,\n        .body .columns th.small-10,\n        .body .column th.small-10,\n        th.small-10 center {\n          display: inline-block !important;\n          width: 83.33333% !important; }\n        .body .columns td.small-11,\n        .body .column td.small-11,\n        td.small-11 center,\n        .body .columns th.small-11,\n        .body .column th.small-11,\n        th.small-11 center {\n          display: inline-block !important;\n          width: 91.66667% !important; }\n        table.body td.small-offset-1,\n        table.body th.small-offset-1 {\n          margin-left: 8.33333% !important;\n          Margin-left: 8.33333% !important; }\n        table.body td.small-offset-2,\n        table.body th.small-offset-2 {\n          margin-left: 16.66667% !important;\n          Margin-left: 16.66667% !important; }\n        table.body td.small-offset-3,\n        table.body th.small-offset-3 {\n          margin-left: 25% !important;\n          Margin-left: 25% !important; }\n        table.body td.small-offset-4,\n        table.body th.small-offset-4 {\n          margin-left: 33.33333% !important;\n          Margin-left: 33.33333% !important; }\n        table.body td.small-offset-5,\n        table.body th.small-offset-5 {\n          margin-left: 41.66667% !important;\n          Margin-left: 41.66667% !important; }\n        table.body td.small-offset-6,\n        table.body th.small-offset-6 {\n          margin-left: 50% !important;\n          Margin-left: 50% !important; }\n        table.body td.small-offset-7,\n        table.body th.small-offset-7 {\n          margin-left: 58.33333% !important;\n          Margin-left: 58.33333% !important; }\n        table.body td.small-offset-8,\n        table.body th.small-offset-8 {\n          margin-left: 66.66667% !important;\n          Margin-left: 66.66667% !important; }\n        table.body td.small-offset-9,\n        table.body th.small-offset-9 {\n          margin-left: 75% !important;\n          Margin-left: 75% !important; }\n        table.body td.small-offset-10,\n        table.body th.small-offset-10 {\n          margin-left: 83.33333% !important;\n          Margin-left: 83.33333% !important; }\n        table.body td.small-offset-11,\n        table.body th.small-offset-11 {\n          margin-left: 91.66667% !important;\n          Margin-left: 91.66667% !important; }\n        table.body table.columns td.expander,\n        table.body table.columns th.expander {\n          display: none !important; }\n        table.body .right-text-pad,\n        table.body .text-pad-right {\n          padding-left: 10px !important; }\n        table.body .left-text-pad,\n        table.body .text-pad-left {\n          padding-right: 10px !important; }\n        table.menu {\n          width: 100% !important; }\n          table.menu td,\n          table.menu th {\n            width: auto !important;\n            display: inline-block !important; }\n          table.menu.vertical td,\n          table.menu.vertical th, table.menu.small-vertical td,\n          table.menu.small-vertical th {\n            display: block !important; }\n        table.menu[align="center"] {\n          width: auto !important; }\n        table.button.expand {\n          width: 100% !important; } }\n\n      @media only screen and (max-width: 596px) {\n        .day-box {\n          padding-top: 2vw !important;\n          width: 14vw !important;\n          height: 14vw !important;\n        }\n        .icon {\n          margin-right: 0.5vw;\n          width: 8px !important;\n        }\n        .icon-container {\n          height: 25%;\n        }\n        .exp-day-label {\n          margin-top: 0% !important;\n          font-size: 15px;\n        }\n        .exp-calendar-content {\n          min-width: 320px;\n          height: 14vw;\n        }\n      }\n\n      @media only screen and (min-width: 596px) {\n        .exp-calendar-content {\n          margin-left: auto;\n          margin-right: auto;\n          width: 78 * 7 + 8;\n          height: 78;\n        }\n        .icon-container {\n          height: 35px;\n        }\n      }\n\n      @media only screen and (max-width: 596px) {\n        .calendar-content {\n          padding: 0px !important;\n          width: 288px !important;\n        }\n\n        .not-available-day, .calendar-today, .available-day {\n          height: 40px !important;\n          width: 40px !important;\n        }\n\n        .day-label {\n          margin-left: 10% !important;\n          margin-top: 0% !important;\n          font-size: 15px;\n        }\n      }\n\n      .gmailfix {\n        display: none;\n        display: none !important;\n      }\n    </style>\n    \n  \n    \n  \n  \n   \n <table class="body" style="border-spacing:0;border-collapse:collapse;vertical-align:top;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;background:#f3f3f3;height:100%;width:100%;color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;margin-bottom:0px !important;background-color: white">\n      <tr style="padding:0;vertical-align:top;text-align:left">\n        <td class="center" align="center" valign="top" style="word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;vertical-align:top;color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;border-collapse:collapse !important">\n          <center style="width:100%;min-width:580px">\n            \x3c!--[if mso]>\n              <table class="container" width="580">\n            <![endif]--\x3e\n            \x3c!--[if !mso]> \x3c!-- --\x3e\n              <table class="container" style="border-spacing:0;border-collapse:collapse;padding:0;vertical-align:top;background:#fefefe;width:580px;margin:0 auto;text-align:inherit;max-width:580px;">\n            \x3c!-- <![endif]--\x3e\n              <tr style="padding:0;vertical-align:top;text-align:left">\n                <td style="word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;vertical-align:top;color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;border-collapse:collapse !important">\n                  <div>\n<table class="row" style="border-spacing:0;border-collapse:collapse;vertical-align:top;text-align:left;padding:0;width:100%;position:relative;display:table">\n  <tr class="" style="padding:0;vertical-align:top;text-align:left">\n    <th class="columns first large-12 last small-12" style="color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;text-align:left;font-size:16px;line-height:19px;margin:0 auto;padding-bottom:16px;width:564px;padding-left:16px;padding-right:16px">\n      <a href="/" style="font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;margin:0;text-align:left;line-height:1.3;color:#2199e8;text-decoration:none">\n<img align="center" alt="Ex2India" class="center standard-header" height="30"    src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAAAAAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCADIAMgDASIAAhEBAxEB/8QAGwABAAIDAQEAAAAAAAAAAAAAAAYHAwQFAQL/xABMEAABAwIDAgcJCwoGAwAAAAAAAQIDBAUGERIhMRMVIkFRYdEUQlJxgZOhscEHIyQyMzVVYnORkhYXNENTVGNy4fBFgqSy0uJlg8L/xAAbAQEAAgMBAQAAAAAAAAAAAAAABAUBAwYCB//EAC4RAAICAgAEBAUEAwEAAAAAAAABAgMEEQUSITETQVFhFDJxgZEVUqHwIiPRwf/aAAwDAQACEQMRAD8A2QAc8fRwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABuQc+4IWnaLRbprTRSyUNK5zoGKrnRtVVXJOo3UUO1vqQM7OWIk3He9+ZVmQLh4ltX0fSeaTsPeJLV9H0nmk7CR8E/3fwVv6/H9j/JToLi4ktX0fSeaTsHElq+j6TzSdg+Cf7v4H6/H9j/JTuQLbqLRbWU0rm2+ma5rVVPeW9HiOFhma13amWCeio21cbeV703lp4SbPvPPwmmk5d/Y2x4zzQc1W9Lv19SAeRT0uHiW1fR9H5lvYaVywxba2ifDHTxQSd5JHGiKi+TmM/BPXRmuHHa20nBr7lVpuPDPWUktFUyU9Q3S9jsl7UMPOQ2tdGX0JxnHmj9T5Vcj6OlZLNLea1sLeTE3bJJ4KdpZcdgtcUDYm0EDsmom2NFVfGpIqxpWLeytzeKV4slHW35lQ5Hq7ELh4ltW7i+k8y3sIZi2sttOvcFBSUzZv1sjI25s6k2bz1PF5Fts1Y3F/iLFCNb/PkREAEQuQAAAAAAAAAAAAXDZPmKi+wZ6kKeQuGyfMVF9gz1IT8Lu/sc9x/wCWH1Z0ec0ai6UFJNwVTVwxSbF0vkRFN4q/G2fH7v5G+0l3WeHHZS4OKsq3w29dCfce2r6QpvOt7Rx7avpCm863tKfBE+Ol6F3+gw/e/wAFs1d6tb6SVrLhSOc5q5e+p0eMqumqZaSqjqYXaZGOzRxiz6gaLb3Y0/QnYfDo40ZR3vZbVivUV5omyN5Mzdkkfgu9qHVyKetVzntNY2ph8Tm8zm9Ba1ur4LpRx1NO7VGv3ovQpPx7/EXXuc7xHAeNPcflf90cvEmHmXmmWWLS2rjb727mcnQpXdFa6qur20McTmzasn6tmnLYqqXKa7KKniqZamOJrZpctbk3rluMW4ynJS/rM4fE7Met19/T2Zr2m1U9oom08Lf5nc7ndKnRBxL/AHyKy0erkunfsjj6V6V6kNzahH2RBip32aXWTNPFGIG2ym7mp3J3XI3Z9ROlfYVq5znv1udqcu/VvXtU+qiolq6mSeZzpJHuzVy/3sMZVX3OxnZ4GFHFr15+bPQAaCcAAAAAAAAAAAAELhsnzFRfYM9SFPIXDZPmKi+wZ6kJ+F3f2Oe4/wDLD6s6BpT2yiqH8JPSQSSeE+Nqr6TbItfMXPs9ydSMo0lyajtXCad/kJ05RityKCim22XLV3OzxJavo6k803sKvvjGw3utjja1rWyqiNRuSISZfdDk+jm+e/oRCuq+7rhPUaeD4Ryv06s8ivyrISjqJ0XCsTIpsk7l0167MIAIRfA7OHL3LZ6zvnQSORJI0+7UnWcYm+EMObW3GsZ0LDG7/cvsN+PGUprlK/iNtMMd+L12u3qThq6/8x9Hp4XBxJqXGtbbrfPVyNc5sTc9KbVUqS5XGe6Vjqmodynbm8zU5kQuNzWPYrXN1NXp5ys8U4edaarumnb8Ekds+ovR4ugh5cZNbXYu+CWUxscZ/M+z/wDCOgArDqwAAAAAAAAAAAAAAAhcNk+YqL7BnqQp4uGyfMVF9gz1IT8Lu/sc9x/5YfVm8QTFGHrncby6opYOEjViJq1om3yqTs+ybZWrFplDjZE8afPDv/0qv8jr5+7J+NO0fkdfP3ZPxp2lqA0fB1+5ZfrmR6L+f+lTvwpeWMc51Imlu1eW3tOKXXWfos/8i+oq3D9hmvNYurU2lZ8o7/5TrI12MoyUYeZY4PE5WVzsv0lHRvYUw7xjN3VVN+CMdsa79Y7sLJa3SmSGKCGKmgbFC1rI2NyRqbkQyE+qtVR0igzMuWTZzvt5I8c9rGanO0tb6CPUGLKOuvMlC3kx7opF3PXn/ocTF2I+Ge+20T/e02TOTvl8FPaQ5F0cpvxm7UI1uXyy1Hy7lnhcIVtTnZ0bXT292XcYqmmiq4HQTNa+N7VRWrzkewriHjSDuaod8Mib+Nu7V4+kkqbiVCSsjtFPbVOixxl0af8AWVPf7JLZqzTynQP+Tk6U6F6zkFy3K3QXSidTVDdTV3O52rzKhVF0tk9prHU0zfi/FdzOb0oVuTj8j2ux1PC+IePHw5/Mv5RpAAiluAAAAAAAAAAAACX0WOX0lFBTJQcJwUbWauGyzyTLPcQ8kGE7I2717pJk94hyVzeZzuZDfQ582oeZAz68d1c962o/+krtmI7lduVT2f3v9o+o0t/27fISGNZnx++Na13gtdqT78kPqONjGNa1ulrdzW7EQw1dfSULOEqp44m82t2WfiLZbS/yZxtko2S/1Q17dWbBgqZKtrNVPBHK7wXyKz2Kc5uKrM9+ltY3V9Zqon35HVimjmY2SN7Xxruc12aKZUlLszEq519Zx19dkQuOL6qke6mq7S6JzmqnKm2L1ouW059vxnFa6NtNT2hGxs/j7VXpXkk1ulrp7vRupqhurPc7navShUldSS2+tmpJvlGOyXr50X0kLIlZW+bf0L3h1eJlRcHDT7tben79yY/nDX6L/wBR/wBTcZdLzf6B7KKg7ia/Z3RJNls6k057uc0cLYWa9ja+4t1Z7YoXbsulewnCNTLJMkNlKskt2P7EPMniUz5aIba89tr8EMgwA3L4RWuc76jUT0rmbH5AW795qfxN/wCJJ56mnpo+Enljib4T3IiGi3EFoc7TxhT+cRD14NK8jV8bmT6qT+y/4R1cEVFHM2pt1w0zMdmzW3L0pzeQ2q3E9xtKtbW2jq4Vs3JcvVyfQSlkjJo9UT2uRe+btzPmWCKogdFM1skbtitdtRT34XKv9fQ8PMc5L4hc2unoyGfnD/8AG/6j/qcq9YogvNHwE1v4N6bY5GzZq1fu3dQxPhril/dNPqdSPd41YvR4iOFfbbav8JM6LDw8KxK6lfy+j/IABFLcAAAAAAAAAAAA+V2oWNgFjOJp398s65/hQrvIleCbxFQ1UlDM/THM5Fa52xEduy8vsJOLJRsWys4vVKzFfL5Pf2LHK1xrS1nGy1EjXOplaiRu3o3pTq2ljhzUfyXM1N6yytr8SPKcriZLxredLZSBIMNYj4mfK2bhJKd7c0azJVR3TtVOb2E6qcNWmr+PRx6l75nJX0HFqsBUb0+DVEkTvrZOT2KQ1jW1vmjovJ8UxMmHh3JrZk/L62/u1V+Fv/I5LVpcU4shkjikbC1iLM17UTPSvUq555ohzbnhO425rpOD4eJO+j25eNN53Pc/gb8Nn77ksT0qvrQypWTmoTX9R4nTjY+PLIxpNvWu/r7E4a3JMjQu9yitNBLVycrT8VvhO3Ih0NxB/dAncjaOn71znPXyZInrUl2z5IN/3qU2HT498YPzIhX3GqudS6aqkc5y7m8zU6EQ1QClcm3tndQrjBckVpHWsV+ns1U3S5zoFd75HzKnSnWWtDKyaBssbtUb2oqO6UUpMtDB0/dGHoUdynROVn3KuXoJ+Ha98rOf45ixjFXR79n7nZrKWKuoZaaZupkrVRSnKymdSVk9NJ8aNytXr/vYXSVjjOJkWIJXN/WMa72ew95kf8eY0cDuatlV5Nb/AAR4AFYdUAAAAAAAAAAAAACZW/BMddb6ep7tVvCMa/ToTZmm7ebK65T6RI2Rl1Y6Ttet/U5lrxdcrcxsb3d0Qpua/eidTiT0eObdL+kMmgdz5t1J96dhq/m+j/f3/gQhNZTPoa2emk+NE9WePr9RI576F17FUqMDOk/D79+m0W3S3m2Vv6PVwvd4Orb9283Uyc3NFKRJJhW9VsV3gpOEkkp5XaFjdt07F2p0bjdVmbepIiZXBXVBzhLeuvUss1aO3wUc08kMejhnI97U3auk2j4kkZCzVI7JupE29KrkhM0ijTfZeZmIF7oEfv8ARyd7pcnpT+pOjiYntLrtaXMj+Widqj61Tm8qGq6LlW0iXgXKnJjKXYqsk2F6Cz3RXU1VGralNrXJIqI9O1CNKx7Hva9uTm7Fa7enYewyy00zZoXObIx2aOTmUqa5KEuq2djk1O6pqEtPyaLM/IuzZfIyZ9PCL2m/ZbU2zUstM12qN0ivb0oi5bFMGHr3DeLfq5LahnJlb0L0p1KdguK4Q0pRRxd9t+3VdJ9/P1Mme8rHG79V/wBPgRNT1r7SyXu4Nj3u2Ima+Ip+713GN2qavvXycn+VNiehDRmy1DRYcDq3e5+SX8mkACrOtAAAAAAAAAAAABPsE3hktHxbK7KWPNWfWTf6CAn1FI+GZskbnRyN2o5NioptptdUtkPOxY5NLg/sXehxLxhqgvL+Eka6OX9ozYq+PpI5a8dvjY2O4Quk/iR718bewkkGKbNUJsrY2/aZt9ZZqyu1dzlJYmXiz5kn9UcNfc9iV/6c7T9nt9Z2LPhegsz+Hj1SzftH83iTmN1L3al/xCkT/wBre0158T2am+NWxu/k5XqChTB7WjM8jNvXI237aOzzEHxreGNZHQQye+akkky73La1PHuXyIYrrjpz2Oit0fB57OEk3+RCGvkfLI6SVznOdtVztqqpovyU1yxLDhvCpqasuWtdl5ln4axDFdqZsUjmtq2NTW3wubUhICkYJ5aeZssEro5G7nN2KhMbXjx7GNiuMOr+JHv8rewzRlprUzXm8InGTnQtr080SK64Ytt2fwskbo5ueSPYq+PmU5Dfc/otfKq6jT/lRfUdmDE9mqWcmujb9pyPWbC3y1J/iFN55O03OFMuvQgxuzKVyJte2mRe42iXDE0d0tep0LNk0auzVW9K9XqJdb6+C40UdTTO1Mf96L0KcitxXZIoXNfNw+bctLE1IqeoiVkxBFabtJwbZG26aTbGu1W/W/vmPHPCuWk+j9PIk/DXZVLlOL5o9n6r0+qJ5fKSeus1TT08nByPbs6+ry7iopI5IZHxStc17XZK1d6KW+l7tS7eMKTxcK3tIfi6lttZ8PoquldUJ8o1sjc3p0pt3njKgprmT7G3g+TKiXhTXR+euzIeACtOqAAAAAAAAAAAAAAAB4egyBmAANIAAwAAAAMwANHh6AZAzGYBgxpAAAyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/9k="                         style="outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;width:auto;max-width:100%;clear:both;display:block;border:none;padding-bottom:16px;padding-top:48px;max-height:30px">      </a>\n    </th>\n  </tr>\n</table>\n</div>\n<div>\n<table class="row" style="border-spacing:0;border-collapse:collapse;vertical-align:top;text-align:left;padding:0;width:100%;position:relative;display:table">\n  <tr class="" style="padding:0;vertical-align:top;text-align:left">\n    <th class="columns first large-12 last small-12" style="color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;text-align:left;font-size:16px;line-height:19px;margin:0 auto;padding-bottom:16px;width:564px;padding-left:16px;padding-right:16px">\n      <p class="headline headline-lg  heavy max-width-485" style=\'padding:0;margin:0;text-align:left;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif;max-width:485px;font-weight:700;color:#484848;word-break:normal;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:32px;line-height:1.3;margin-bottom:0 !important;\'>\n        Did you change your password?\n      </p>\n    </th>\n  </tr>\n</table>\n</div>\n<div style="padding-bottom:16px">\n<table class="row" style="border-spacing:0;border-collapse:collapse;vertical-align:top;text-align:left;padding:0;width:100%;position:relative;display:table">\n  <tr class="" style="padding:0;vertical-align:top;text-align:left">\n    <th class="columns first large-12 last small-12" style="color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;text-align:left;font-size:16px;line-height:19px;margin:0 auto;padding-bottom:16px;width:564px;padding-left:16px;padding-right:16px">\n      <p class="body  body-lg  body-link-rausch light text-left   " style=\'padding:0;margin:0;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif;font-weight:300;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;text-align:left;margin-bottom:0px !important;\'>\nWe noticed the password for your account was recently changed. If this was you, you can safely disregard this email</p>\n    </th>\n  </tr>\n</table>\n</div>\n<div>\n<table class="row" style="border-spacing:0;border-collapse:collapse;vertical-align:top;text-align:left;padding:0;width:100%;position:relative;display:table">\n  <tr class="" style="padding:0;vertical-align:top;text-align:left">\n    <th class="columns first large-12 last small-12" style="color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;text-align:left;font-size:16px;line-height:19px;margin:0 auto;padding-bottom:16px;width:564px;padding-left:16px;padding-right:16px">\n      <div class="account-alert-card account-alert-card-border" style="border-radius:4px;border-color:#dbdbdb;border-width:1px;border-style:solid">\n        <div class="account-alert-card-with-padding" style="padding-top:36px;padding-bottom:20px;padding-left:36px;padding-right:36px">\n          <p class="body body-lg bold" style=\'padding:0;margin:0;text-align:left;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif;font-weight:bold;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important\'>\n            Changed password\n          </p>\n        </div>\n        <p style=\'color:#0a0a0a;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;margin-bottom:10px;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif\'>\n        </p>\n        <hr class="full-divider" style="max-width:580px;border-right:0;border-top:0;border-bottom:1px solid #cacaca;border-left:0;margin:20px auto;clear:both;background-color:#dbdbdb;height:1px;border:none;width:100%;margin-top:0;margin-bottom:0">\n        <div class="account-alert-card-with-padding" style="padding-top:36px;padding-bottom:20px;padding-left:36px;padding-right:36px">\n          <p style=\'color:#0a0a0a;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;margin-bottom:10px;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif\'>\n            <span class="body body-lg bold" style="font-weight:bold;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important">\n              When\n            </span>\n                <span class="body body-lg light" style="font-weight:300;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important">\n             '.concat(i,'\n            </span>\n          </p>\n          <p style=\'color:#0a0a0a;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;margin-bottom:10px;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif\'>\n            <span class="body body-lg bold" style="font-weight:bold;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important">\n              Where\n            </span>\n                <span class="body body-lg light" style="font-weight:300;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important">\n             Faridabad\n            </span>\n          </p>\n          <p style=\'color:#0a0a0a;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;margin-bottom:10px;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif\'>\n            <span class="body body-lg bold" style="font-weight:bold;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important">\n              Device Type\n            </span>\n                <span class="body body-lg light" style="font-weight:300;color:#484848;hyphens:none;-moz-hyphens:none;-webkit-hyphens:none;-ms-hyphens:none;font-size:18px;line-height:1.4;margin-bottom:0px !important">\n              Chrome\n            </span>\n          </p>\n        </div>\n        <hr class="full-divider" style="max-width:580px;border-right:0;border-top:0;border-bottom:1px solid #cacaca;border-left:0;margin:20px auto;clear:both;background-color:#dbdbdb;height:1px;border:none;width:100%;margin-top:0;margin-bottom:0">\n        <div class="account-alert-card-button-container" style="padding-top:16px;padding-bottom:16px;padding-left:0px;padding-right:0px">\n          <table class="row" style="border-spacing:0;border-collapse:collapse;vertical-align:top;text-align:left;padding:0;position:relative;width:100%;display:table">\n            <tr style="padding:0;vertical-align:top;text-align:left">\n              <th class="col-pad-left-2 col-pad-right-2" style="color:#0a0a0a;font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;padding:0;margin:0;text-align:left;font-size:16px;line-height:19px;padding-left:16px;padding-right:16px">\n                <a href=').concat(a,' class="btn-primary btn-sm btn-rausch btn-full-width" style="font-family:\'Cereal\', Helvetica, Arial, sans-serif;font-weight:normal;margin:0;text-align:left;line-height:1.3;color:#2199e8;text-decoration:none;background-color:#ff5a5f;-webkit-border-radius:4px;border-radius:4px;display:block;padding:19px 24px 19px 24px;">\n                  <p class="text-center" style=\'font-weight:normal;padding:0;margin:0;font-size:16px;line-height:19px;text-align:center;font-family:"Cereal", "Helvetica", Helvetica, Arial, sans-serif;color:white;margin-bottom:0px !important;\'>\n                    Change Password\n                  </p>\n                </a>\n              </th>\n            </tr>\n          </table>\n        </div>\n      </div>\n    </th>\n  </tr>\n</table>\n</div>\n\n                </td>\n              </tr>\n            </table>\n          </center>\n        </td>\n      </tr>\n    </table>\n    \x3c!-- Gmail on iOS will automatically increase font-size for readability --\x3e\n    \x3c!-- http://freshinbox.com/blog/gmail-supports-displaynone-and-gmail-ios-font-fix-update/ --\x3e\n  \n  \n\n</body>\n</html>\n\n'),t.next=7,n.sendMail({from:process.env.SMTP_USER,to:e,subject:"Password Reset",html:o});case 7:t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(2),new A("Something Wrong with email services");case 12:case"end":return t.stop()}var a,i}),t,null,[[2,9]])})));return function(e,r){return t.apply(this,arguments)}}(),F=function(){var t=N(T().mark((function t(e,r){var n;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("pdf file and email are",e,r),t.prev=1,n=s.createTransport({host:process.env.SMTP_HOST,port:process.env.SMTP_PORT,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}}),t.next=5,n.sendMail({from:process.env.SMTP_USER,to:r,subject:"Letter Sent",html:u,attachments:[{filename:"letter.pdf",content:new Buffer(e.buffer,"utf-8")}]});case 5:t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(1),console.log(t.t0,"email not sent"),new E(t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,r){return t.apply(this,arguments)}}(),q=function(){var t=N(T().mark((function t(e,r){var n,o;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=s.createTransport({host:process.env.SMTP_HOST,port:process.env.SMTP_PORT,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}}),o=O(e,r,"http://ipvms.exitest.com/login"),t.next=6,n.sendMail({from:process.env.SMTP_USER,to:e,subject:"Invitation to platform",html:o});case 6:return t.sent,t.abrupt("return",!0);case 10:throw t.prev=10,t.t0=t.catch(0),new x("email not sent");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r){return t.apply(this,arguments)}}(),G=function(){for(var t="@1T",e=0;e<8;++e)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(62*Math.random()));return t};function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function U(){U=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==M(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(M(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function D(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function H(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){D(a,n,o,i,c,"next",t)}function c(t){D(a,n,o,i,c,"throw",t)}i(void 0)}))}}var V=function(){var t=H(U().mark((function t(e){var r,n;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,t.prev=1,t.next=4,a.query("SELECT * FROM user_table WHERE email=$1",[r]);case 4:return n=t.sent,t.abrupt("return",n);case 8:throw t.prev=8,t.t0=t.catch(1),t.t0;case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),B=function(){var t=H(U().mark((function t(e){var r,n,o,i,c,s,u;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.firstName,n=e.lastName,o=e.email,i=e.hashedPassword,c=e.isActive,console.log(r,n,o,i,c),t.prev=2,s={text:"INSERT INTO user_table(first_name,last_name,email,password,is_active) VALUES($1,$2,$3,$4,$5) RETURNING *",values:[r,n,o,i,!0]},t.next=6,a.query(s);case 6:return u=t.sent,t.abrupt("return",u);case 10:throw t.prev=10,t.t0=t.catch(2),new x("Error in creating User");case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=H(U().mark((function t(e){var r,n,o,i,c,s,u;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.firstName,n=e.lastName,o=e.email,i=e.hashedPassword,c=e.isActive,console.log(r,n,o,i,c),t.prev=2,s={text:"UPDATE user_table SET first_name=$1,last_name=$2,email=$3,password=$4,password_reset=$5 WHERE email=$3 RETURNING *",values:[r,n,o,i,!0]},t.next=6,a.query(s);case 6:return u=t.sent,console.log(u.rows[0]),t.abrupt("return",u);case 11:throw t.prev=11,t.t0=t.catch(2),new x("Error in updating User");case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=H(U().mark((function t(){var e;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.query("SELECT first_name,last_name,created_at,updated_at,email,id FROM user_table");case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),new x("Error in getting User");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),$=function(){var t=H(U().mark((function t(e){var r,n,o;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.hashedPassword,n=e.userId,t.prev=1,t.next=4,a.query("UPDATE user_table SET password=$1 WHERE id=$2 RETURNING *",[r,n]);case 4:return o=t.sent,t.abrupt("return",o);case 8:throw t.prev=8,t.t0=t.catch(1),new x("Error in Update password");case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),Z=function(){var t=H(U().mark((function t(e){var r,n,o,i;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(null==(r=e)?void 0:r.split(" ")[0])||"",o=(null==r?void 0:r.split(" ")[1])||"",console.log(n,o),t.prev=4,t.next=7,a.query(" SELECT first_name,last_name,created_at,updated_at,email,id FROM user_table WHERE first_name ILIKE '%'||$1||'%' or last_name ILIKE '%'||$1||'%' and last_name ILIKE '%'||$2||'%'  ",[n,o]);case 7:return i=t.sent,t.abrupt("return",i);case 11:throw t.prev=11,t.t0=t.catch(4),new x("Error in getting User");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}();function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Y(){Y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==J(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(J(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function X(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var K=function(){var t,e=(t=Y().mark((function t(e){var r,n;return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new E("password is null");case 3:return t.next=5,i.genSalt(10);case 5:return r=t.sent,t.next=8,i.hash(e,r);case 8:if(n=t.sent){t.next=11;break}throw new E("not able to genertae hash password");case 11:return t.abrupt("return",n);case 14:throw t.prev=14,t.t0=t.catch(0),t.t0;case 17:case"end":return t.stop()}}),t,null,[[0,14]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){X(a,n,o,i,c,"next",t)}function c(t){X(a,n,o,i,c,"throw",t)}i(void 0)}))});return function(t){return e.apply(this,arguments)}}();function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function tt(){tt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Q(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Q(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function et(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function rt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){et(a,n,o,i,c,"next",t)}function c(t){et(a,n,o,i,c,"throw",t)}i(void 0)}))}}var nt=function(){var t=rt(tt().mark((function t(e){var r,n,o,a,c,s,u,l;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.firstName,n=e.lastName,o=e.email,a=e.password,e.updatedBy,t.next=3,i.genSalt(10);case 3:return c=t.sent,t.next=6,i.hash(a,c);case 6:return s=t.sent,t.prev=7,t.next=10,V({email:o});case 10:if(!(t.sent.rows.length>0)){t.next=13;break}throw new j("User email already Exist");case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(7),t.t0;case 18:return t.prev=18,console.log(r,n,o,a),t.next=23,B({firstName:r,lastName:n,email:o,hashedPassword:s,isActive:!0});case 23:return u=t.sent,delete(l=u.rows[0]).password,t.abrupt("return",l);case 29:throw t.prev=29,t.t1=t.catch(18),t.t1;case 32:case"end":return t.stop()}}),t,null,[[7,15],[18,29]])})));return function(e){return t.apply(this,arguments)}}(),ot=function(){var t=rt(tt().mark((function t(e){var r,n,o,a,c,s,u;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.firstName,n=e.lastName,o=e.email,a=e.password,e.updatedBy,console.log(e),console.log(r,n,o,a),t.next=5,i.genSalt(10);case 5:return c=t.sent,t.next=8,i.hash(a,c);case 8:return s=t.sent,t.prev=9,console.log(r,n,o,s),t.next=14,z({firstName:r,lastName:n,email:o,hashedPassword:s,isActive:!0});case 14:return u=t.sent,t.abrupt("return",u.rows[0]);case 18:throw t.prev=18,t.t0=t.catch(9),t.t0;case 21:case"end":return t.stop()}}),t,null,[[9,18]])})));return function(e){return t.apply(this,arguments)}}(),at=function(){var t=rt(tt().mark((function t(e){var r,n,o,a,s;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,n=e.password,t.prev=1,t.next=4,V({email:r});case 4:if(o=t.sent,console.log("email",o.rows[0]),0!==o.rows.length){t.next=8;break}throw new L("User not found");case 8:return t.next=10,i.compare(n,o.rows[0].password);case 10:if(t.sent){t.next=13;break}throw new E("invalid credentials");case 13:return a=c.sign({id:o.rows[0].id},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRY_TIME}),delete(s=o.rows[0]).password,t.abrupt("return",{users:s,token:a});case 19:throw t.prev=19,t.t0=t.catch(1),t.t0;case 22:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(e){return t.apply(this,arguments)}}(),it=function(){var t=rt(tt().mark((function t(){var e;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,W();case 3:if(0!==(e=t.sent).rows.length){t.next=6;break}throw new L("User not found");case 6:return t.abrupt("return",e.rows);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),ct=function(){var t=rt(tt().mark((function t(e){var r,n;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,V({email:e});case 3:if(0!==(r=t.sent).rows.length){t.next=6;break}throw new L("User not found");case 6:return t.prev=6,n=c.sign({id:r.rows[0].id},process.env.JWT_SECRET,{expiresIn:"1h"}),t.abrupt("return",n);case 11:throw t.prev=11,t.t0=t.catch(6),new x("error in generating token");case 14:t.next=19;break;case 16:throw t.prev=16,t.t1=t.catch(0),t.t1;case 19:case"end":return t.stop()}}),t,null,[[0,16],[6,11]])})));return function(e){return t.apply(this,arguments)}}(),st=function(){var t=rt(tt().mark((function t(e,r){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R(e,r);case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),t.t0;case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,r){return t.apply(this,arguments)}}(),ut=function(){var t=rt(tt().mark((function t(e,r){var n,o,a,s,u;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.genSalt(10);case 3:return n=t.sent,t.next=6,i.hash(e,n);case 6:return o=t.sent,t.next=9,$({hashedPassword:o,userId:r});case 9:return a=t.sent,s=a.rows[0],u=c.sign({id:r},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRY_TIME}),delete s.password,console.log(s,u),t.abrupt("return",{users:s,token2:u});case 17:throw t.prev=17,t.t0=t.catch(0),t.t0;case 20:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,r){return t.apply(this,arguments)}}(),lt=function(){var t=rt(tt().mark((function t(e,r){var n,o,a,s,u;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.genSalt(10);case 3:return n=t.sent,t.next=6,i.hash(e,n);case 6:return o=t.sent,t.next=9,$({hashedPassword:o,userId:r});case 9:return a=t.sent,s=c.sign({id:r},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRY_TIME}),delete(u=a.rows[0]).password,t.abrupt("return",{user:u,token:s});case 16:throw t.prev=16,t.t0=t.catch(0),new E("error in reseting password");case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,r){return t.apply(this,arguments)}}(),pt=function(){var t=rt(tt().mark((function t(e){var r,n,o;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.email){t.next=4;break}throw new E("missing fields");case 4:return t.next=8,V({email:r});case 8:if(!(t.sent.rows.length>0)){t.next=13;break}throw new j("User email already Exist");case 13:return n=G(),t.next=16,K(n);case 16:if(!(o=t.sent)){t.next=27;break}return t.next=21,B({email:r,hashedPassword:o,isActive:!0});case 21:if(!t.sent){t.next=27;break}return t.next=25,q(r,n);case 25:t.sent,console.log("mail success");case 27:t.next=32;break;case 29:throw t.prev=29,t.t0=t.catch(0),t.t0;case 32:case"end":return t.stop()}}),t,null,[[0,29]])})));return function(e){return t.apply(this,arguments)}}(),ft=function(){var t=rt(tt().mark((function t(e){var r;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z(e);case 3:if(0!==(r=t.sent).rows.length){t.next=6;break}throw new L("User not found");case 6:return t.abrupt("return",r.rows);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),ht=function(t){if(!new RegExp("^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+$").test(t))return{error:"Invalid Email format",success:!1};var e=t.indexOf("@");return t.slice(e+1).toLowerCase(),{success:!0}},dt=function(t){return/[A-Z]/.test(t)?/[a-z]/.test(t)?/[0-9]/.test(t)?/[^A-Za-z0-9]/.test(t)?t.length<4?{error:"Password should be more than 4 character",success:!1}:{success:!0}:{error:"Password should contain at least one special symbol",success:!1}:{error:"Password should contain at least one digit",success:!1}:{error:"Password should contain at least one lowercase letter",success:!1}:{error:"Password should contain at least one uppercase letter",success:!1}};function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function mt(){mt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==yt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(yt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function vt(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function gt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){vt(a,n,o,i,c,"next",t)}function c(t){vt(a,n,o,i,c,"throw",t)}i(void 0)}))}}var bt=o.resolve();n.config({path:o.resolve(bt,"../../../.env")});var wt=function(){var t=gt(mt().mark((function t(e,r,n){var o;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,nt(e.body);case 3:return o=t.sent,t.abrupt("return",r.status(201).json({success:!0,message:"User Registered",data:o}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}(),xt=function(){var t=gt(mt().mark((function t(e,r,n){var o,a,i;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,at(e.body);case 3:return o=t.sent,a=o.users,i=o.token,t.abrupt("return",r.status(200).json({success:!0,message:"Login Success",token:i,user:a}));case 9:t.prev=9,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Et=function(){var t=gt(mt().mark((function t(e,r,n){var o;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,it();case 3:return o=t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"all users are",data:o}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Lt=function(){var t=gt(mt().mark((function t(e,r,n){var o,a;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.body.email){t.next=3;break}return t.abrupt("return",r.status(400).json({success:!1,message:"Email is required"}));case 3:return t.prev=3,t.next=6,ct(o);case 6:if(!(a=t.sent)){t.next=11;break}return t.next=10,st(o,a);case 10:return t.abrupt("return",r.status(200).json({success:!0,message:"Email sent",secretToken:a}));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),n(t.t0);case 16:case"end":return t.stop()}}),t,null,[[3,13]])})));return function(e,r,n){return t.apply(this,arguments)}}(),_t=function(){var t=gt(mt().mark((function t(e,r,n){var o,a,i,c,s,u;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.body,a=o.password,o.confirmPassword,void 0!==(i=e.user.id)){t.next=4;break}throw new L("user not found");case 4:return t.prev=4,t.next=7,ut(a,i);case 7:return c=t.sent,s=c.users,u=c.token2,t.abrupt("return",r.status(200).json({success:!0,message:"Password reset Success",user:s,token:u}));case 13:t.prev=13,t.t0=t.catch(4),n(t.t0);case 16:case"end":return t.stop()}}),t,null,[[4,13]])})));return function(e,r,n){return t.apply(this,arguments)}}(),jt=function(){var t=gt(mt().mark((function t(e,r,n){var o,a,i,c,s,u;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.user.id,a=e.body,i=a.password,a.confirmPassword,t.prev=2,void 0!==o){t.next=5;break}throw new L("user not found");case 5:return t.next=7,lt(i,o);case 7:return c=t.sent,s=c.user,u=c.token,t.abrupt("return",r.status(200).json({success:!0,message:"Password reset Success",user:s,token:u}));case 13:t.prev=13,t.t0=t.catch(2),n(t.t0);case 16:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e,r,n){return t.apply(this,arguments)}}(),kt=function(){var t=gt(mt().mark((function t(e,r,n){var o,i,c;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.user.id,console.log(o,"user Id"),t.next=5,a.query("SELECT * FROM user_table as u WHERE u.id=$1",[o]);case 5:if(i=t.sent,c=i.rows[0],console.log(c),0!==i.rows.length){t.next=10;break}return t.abrupt("return",r.status(404).json({success:!1,message:"User not found"}));case 10:return t.abrupt("return",r.status(200).json({status:"success",data:c,message:"User Info"}));case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({success:!1,message:"Internal Server Error",error:t.t0.message}));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,r,n){return t.apply(this,arguments)}}(),At=function(){var t=gt(mt().mark((function t(e,r,n){var o,i,c;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.params.id,console.log(o,"user Id"),t.next=5,a.query("SELECT u.first_name,u.last_name,u.email,u.created_at,u.updated_at,u.updated_by,u.is_active,u.employee_code,u.mobile_number,b.business_unit,b.department,b.department,b.subdepartment,b.designation FROM user_table AS u \n      JOIN user_position AS b ON u.id=b.user_id WHERE u.id=$1",[o]);case 5:if(i=t.sent,c=i.rows[0],console.log(c),0!==i.rows.length){t.next=10;break}return t.abrupt("return",r.status(404).json({success:!1,message:"User not found"}));case 10:return t.abrupt("return",r.status(200).json({status:"success",data:c,message:"User Info"}));case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({success:!1,message:"Internal Server Error",error:t.t0.message}));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,r,n){return t.apply(this,arguments)}}(),St=function(){var t=gt(mt().mark((function t(e,r,n){return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(e.body.email).success){t.next=4;break}throw console.log("emai, format"),new E("Invalid email format");case 4:return t.next=6,pt(e.body);case 6:return t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"Invitation send successfully"}));case 10:t.prev=10,t.t0=t.catch(0),n(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ot=function(){var t=gt(mt().mark((function t(e,r,n){var o,i;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.user){t.next=3;break}throw new _("User is not logged in,log in first to setup your account");case 3:return o=e.user.id,t.next=6,a.query("SELECT * FROM user_table WHERE id=$1",[o]);case 6:if(!t.sent.password_reset){t.next=11;break}throw new S("Account is already setup for user");case 11:return t.next=13,ot(e.body);case 13:return i=t.sent,console.log(i),t.abrupt("return",r.status(201).json({success:!0,message:"User Registered Success"}));case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),n(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ct=function(){var t=gt(mt().mark((function t(e,r,n){var o,a;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=e.query.name,console.log(o),""!==o){t.next=5;break}return t.abrupt("return",r.status(200).json({success:!0,message:"all users are",data:null}));case 5:return t.next=7,ft(o);case 7:return a=t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"all users are",data:a}));case 11:t.prev=11,t.t0=t.catch(0),n(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,r,n){return t.apply(this,arguments)}}();function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}function It(){It=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Tt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Tt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Nt(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Pt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Nt(a,n,o,i,c,"next",t)}function c(t){Nt(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Rt=o.resolve();n.config({path:o.resolve(Rt,"../../.env")});var Ft=function(){var t=Pt(It().mark((function t(e,r,n){var o,a,i;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.body,a=o.email,i=o.password,a&&i&&dt(i).success&&ht(a).success||n(new E("validation error")),n();case 3:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),qt=function(){var t=Pt(It().mark((function t(e,r,n){var o,a,i,c,s;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("in middleware"),o=e.body,a=o.firstName,i=o.lastName,c=o.email,s=o.password,o.updatedBy,a&&i&&c&&s&&dt(s).success&&ht(c).success||n(new E("validation error")),n();case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),Gt=function(){var t=Pt(It().mark((function t(e,r,n){var o,a,i;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(o=e.header("Authorization"))&&o.startsWith("Bearer")||n(new _("Invalid authorization header")),(a=null==o?void 0:o.replace("Bearer ",""))||n(new _("Authorization token not found"));try{console.log(a),i=c.verify(a,process.env.JWT_SECRET),e.user=i,n()}catch(t){n(new _("Invalid token"))}case 5:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),Mt=function(){var t=Pt(It().mark((function t(e,r,n){var o,a,i;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.body,a=o.password,i=o.confirmPassword,a&&i||n(new E("Password and confirm pasword are required")),dt(a).success||n(new E("password invalid")),a!==i&&n(new E("Password and Confirm Password does not match")),n();case 5:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),Ut=function(){var t=Pt(It().mark((function t(e,r,n){var o,a;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.params.token,console.log(o,"in token middleware"),o||n(new k("Invalid token"));try{try{a=c.verify(o,process.env.JWT_SECRET),e.user=a}catch(t){n(new k("Token either expired or invalid"))}n()}catch(t){n(new x("Internal Server Error"))}case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),Dt=t.Router();Dt.post("/registerUser",qt,wt),Dt.post("/loginUser",Ft,xt),Dt.get("/getAllUsers",Et),Dt.get("/getUsers",Ct),Dt.post("/forgotPassword",Lt),Dt.post("/resetPassword/:token",Ut,Mt,_t),Dt.post("/resetPassword",Gt,Mt,jt),Dt.get("/getUserInfo",Gt,kt),Dt.get("/getUserById/:id",At),Dt.get("/getUserInfo/:id",At),Dt.post("/sendInvite",St),Dt.post("/accountsetup",Gt,Ot);const Ht=Dt,Vt=require("compression");function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function zt(){zt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Bt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Bt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Wt(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function $t(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Wt(a,n,o,i,c,"next",t)}function c(t){Wt(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Zt=function(){var t=$t(zt().mark((function t(e){var r,n,o,i,c,s;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.htmlData,n=e.htmljson,o=e.name,i=e.userid,c=e.mode,console.log(o,"sss"),console.log("hit"),t.prev=3,t.next=6,a.query("INSERT INTO  template   (htmldata,title,htmljson,created_by,mode) VALUES($1,$2,$3,$4,$5) RETURNING *",[r,o,n,i,c]);case 6:return s=t.sent,t.abrupt("return",s.rows);case 10:throw t.prev=10,t.t0=t.catch(3),new Error("Error"+t.t0.message);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e){return t.apply(this,arguments)}}(),Jt=function(){var t=$t(zt().mark((function t(e){var r,n;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.id,t.prev=1,t.next=4,a.query("SELECT convert_from(htmldata,'utf8') as htmldata,title,mode,description,htmljson,created_at FROM template WHERE id=$1",[r]);case 4:return n=t.sent,t.abrupt("return",n);case 8:throw t.prev=8,t.t0=t.catch(1),new Error("Error"+t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),Yt=function(){var t=$t(zt().mark((function t(e,r,n){var o,i;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={text:"\n    WITH paginated_data AS (\n      SELECT \n          id, \n          category_id as cid,\n          created_at, \n          created_by, \n          title,\n          is_active\n      FROM document d\n      WHERE \n      d.is_active = TRUE and\n      title ILIKE '%'||$3||'%'\n      ORDER BY ".concat(r," ").concat(n,"\n  ),\n  filtered_data AS (\n      SELECT \n          pd.*, \n          c.category as category_name, \n          ut.first_name\n      FROM \n          paginated_data pd\n      JOIN \n          user_table ut ON pd.created_by = ut.id\n      JOIN  \n          category c ON c.id=pd.cid\n      WHERE \n          c.category ILIKE '%'||$4||'%'\n  ),\n  total_count AS (\n      SELECT \n          COUNT(*) as total_count \n      FROM \n          filtered_data\n  )\n  SELECT \n      fd.*, \n      (SELECT total_count FROM total_count) as total_count\n  FROM \n      filtered_data fd\n  LIMIT $1 OFFSET $2;\n    "),values:e},t.prev=1,t.next=4,a.query(o);case 4:return i=t.sent,t.abrupt("return",i);case 8:throw t.prev=8,t.t0=t.catch(1),new x("Error while getting documents details.");case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Xt=function(){var t=$t(zt().mark((function t(e,r,n){var o,i;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={text:"\n    WITH paginated_data AS (\n      SELECT \n          id, \n          category_id as cid,\n          created_at, \n          created_by, \n          title\n      FROM document d\n      WHERE \n      title ILIKE '%'||$3||'%' and  d.is_active = FALSE\n      ORDER BY ".concat(r," ").concat(n,"\n  ),\n  filtered_data AS (\n      SELECT \n          pd.*, \n          c.category as category_name, \n          ut.first_name\n      FROM \n          paginated_data pd\n      JOIN \n          user_table ut ON pd.created_by = ut.id\n      JOIN  \n          category c ON c.id=pd.cid\n      WHERE \n          c.category ILIKE '%'||$4||'%'\n  ),\n  total_count AS (\n      SELECT \n          COUNT(*) as total_count \n      FROM \n          filtered_data\n  )\n  SELECT \n      fd.*, \n      (SELECT total_count FROM total_count) as total_count\n  FROM \n      filtered_data fd\n  LIMIT $1 OFFSET $2;\n    "),values:e},t.prev=1,t.next=4,a.query(o);case 4:return i=t.sent,t.abrupt("return",i);case 8:throw t.prev=8,t.t0=t.catch(1),new x("Error while getting documents details.");case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Kt=function(){var t=$t(zt().mark((function t(e){var r;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(e,"user id us"),t.next=4,a.query("SELECT l.id, \n      t.title, \n      TO_CHAR(l.created_at, 'FMMonth FMDD, YYYY') AS created_at \nFROM letters l \nINNER JOIN template t \n       ON t.id = l.template_id \nWHERE userid = $1 \n AND status != 'DRAFT' \nORDER BY l.created_at DESC",[e]);case 4:return r=t.sent,t.abrupt("return",r);case 8:throw t.prev=8,t.t0=t.catch(0),console.log(t.t0.message),new x("Error in fetching letter");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),Qt=function(t,e){return{limit:e?+e:5,offset:t*e?t*e:0}};function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(){ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==te(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(te(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function re(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function ne(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){re(a,n,o,i,c,"next",t)}function c(t){re(a,n,o,i,c,"throw",t)}i(void 0)}))}}var oe=function(){var t=ne(ee().mark((function t(e,r,n,o,a,i,c,s){var u;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Zt({name:r,description:n,categoryId:o,htmlData:a,htmljson:c,mode:i,userid:s});case 3:if(u=t.sent){t.next=6;break}return t.abrupt("return",e.status(400).json({success:!1,message:"Template not uploaded"}));case 6:return t.abrupt("return",e.status(200).json({success:!0,message:"Template uploaded",document:u}));case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",e.status(400).json({message:t.t0.message,success:!1}));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n,o,a,i,c,s){return t.apply(this,arguments)}}(),ae=function(){var t=ne(ee().mark((function t(e,r){var n;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Jt({id:r});case 3:if(0!==(n=t.sent).rows.length){t.next=6;break}return t.abrupt("return",e.status(404).json({success:!1,message:"No template found"}));case 6:return t.abrupt("return",e.status(200).json({success:!0,message:"Template fetched",data:n.rows}));case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",e.status(400).json({message:t.t0.message,success:!1}));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r){return t.apply(this,arguments)}}(),ie=function(){var t=ne(ee().mark((function t(e,r){var n,o,i,c,s,u;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.htmlText,o=e.htmlJson,i=e.categoryId,c=e.title,s=Buffer.from(n,"utf8"),console.log(),console.log("hit"),t.prev=4,t.next=7,a.query("INSERT INTO  document   (htmldata,category_id,title,htmljson,created_by) VALUES($1,$2,$3,$4,$5) RETURNING *",[s,i,c,o,r]);case 7:return u=t.sent,t.abrupt("return",u.rows[0]);case 11:throw t.prev=11,t.t0=t.catch(4),console.log(t.t0.message),new x("cant create policy");case 15:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e,r){return t.apply(this,arguments)}}(),ce=function(){var t=ne(ee().mark((function t(e){var r,n,o,a,i,c,s,u,l,p,f,h,d;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.query,o=e.query.title,a=e.query.category,console.log(o),i=parseInt(n.page),c=parseInt(n.size),s=Qt(i,c),u=s.limit,l=s.offset,console.log(a),p=(null==n?void 0:n.orderByColumn)||"created_at",f=(null==n||null===(r=n.orderByDirection)||void 0===r?void 0:r.toUpperCase())||"ASC",t.prev=10,"Draft"===a){t.next=17;break}return t.next=14,Yt([u,l,o,a],p,f);case 14:h=t.sent,t.next=21;break;case 17:return a="",t.next=20,Xt([u,l,o,a],p,f);case 20:h=t.sent;case 21:if(0==h.rowCount){t.next=26;break}return d={length:h.rowCount,rows:h.rows},t.abrupt("return",d);case 26:throw new L("No documents found.");case 27:t.next=32;break;case 29:throw t.prev=29,t.t0=t.catch(10),t.t0;case 32:case"end":return t.stop()}}),t,null,[[10,29]])})));return function(e){return t.apply(this,arguments)}}(),se=function(){var t=ne(ee().mark((function t(e){var r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Kt(e);case 3:return r=t.sent,t.abrupt("return",r);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function le(){le=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ue(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ue(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function pe(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var fe=new(require("minio").Client)({endPoint:"minio-endpoint.skilldify.ai",port:443,useSSL:!0,accessKey:"037UPKHTR2OlYlZW",secretKey:"caB5V71k1dBmYhhUN8PqlBNkJRJk6UR4"});function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function de(){de=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==he(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(he(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function ye(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function me(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ye(a,n,o,i,c,"next",t)}function c(t){ye(a,n,o,i,c,"throw",t)}i(void 0)}))}}!function(){var t,e=(t=le().mark((function t(){return le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fe.bucketExists("ipvms-dev");case 3:console.log("MinIO connection verified successfully."),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error connecting to MinIO:",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){pe(a,n,o,i,c,"next",t)}function c(t){pe(a,n,o,i,c,"throw",t)}i(void 0)}))});return function(){return e.apply(this,arguments)}}()(),o.resolve();var ve=function(){var t=me(de().mark((function t(e,r){var n,o,i,c;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body,o=n.htmlText,i=n.docId,c=n.htmljson,i=parseInt(i),!(Buffer.byteLength(o,"utf8")>10485760)){t.next=5;break}return t.abrupt("return",r.status(400).json({success:!1,message:"File size should be less than 10MB"}));case 5:if(void 0!==o){t.next=7;break}return t.abrupt("return",r.status(400).json({success:!1,message:"File not uploaded,Invalid input"}));case 7:return t.prev=7,t.next=10,a.query("UPDATE document SET htmldata=$1, htmljson=$2  WHERE id=$3 RETURNING *",[o,c,i]);case 10:if(0!==t.sent.rowCount){t.next=13;break}return t.abrupt("return",r.status(400).json({success:!1,message:"File not uploaded"}));case 13:return t.abrupt("return",r.status(201).json({success:!0,message:"File uploaded"}));case 16:return t.prev=16,t.t0=t.catch(7),t.abrupt("return",r.status(500).json({error:t.t0.message,success:!1,message:"Internal Server Error"}));case 19:case"end":return t.stop()}}),t,null,[[7,16]])})));return function(e,r){return t.apply(this,arguments)}}(),ge=function(){var t=me(de().mark((function t(e,r){var n,o;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.params.docId,console.log(n),n=parseInt(n)){t.next=5;break}return t.abrupt("return",r.status(400).json({success:!1,message:"Document Id is required"}));case 5:return t.prev=5,t.next=8,a.query("SELECT \n      d.title,  \n      d.htmljson, \n      convert_from(d.htmldata, 'utf8') AS data,\n      d.category_id,\n      c.category,\n      d.is_active \n  FROM \n      document d\n  JOIN \n      category c ON d.category_id = c.id\n  WHERE \n      d.id = $1;",[n]);case 8:if(0!==(o=t.sent).rows.length){t.next=11;break}return t.abrupt("return",r.status(400).json({success:!1,message:"File not found ,invalid document id"}));case 11:return t.abrupt("return",r.status(200).json({success:!0,message:"File fetched",data:o.rows[0]}));case 14:return t.prev=14,t.t0=t.catch(5),t.abrupt("return",r.status(500).json({error:t.t0.message,success:!1,message:"Internal Server Error"}));case 17:case"end":return t.stop()}}),t,null,[[5,14]])})));return function(e,r){return t.apply(this,arguments)}}(),be=function(){var t=me(de().mark((function t(e,r){var n,o,a,i,c,s,u,l,p;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.user.id,o=e.body,a=o.name,i=o.description,c=o.categoryId,s=o.htmlText,u=o.mode,l=o.htmljson,t.prev=2,p=Buffer.from(s,"utf8"),t.next=6,oe(r,a,i,c,p,u,l,n);case 6:t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",r.status(500).json({success:!1,message:"Internal Server Error",error:t.t0.message}));case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,r){return t.apply(this,arguments)}}(),we=function(){var t=me(de().mark((function t(e,r){var n;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.params.id,console.log(n),n){t.next=4;break}return t.abrupt("return",r.status(400).json({success:!1,message:"Invalid params"}));case 4:return t.prev=4,t.next=7,ae(r,n);case 7:t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(4),t.abrupt("return",r.status(500).json({success:!1,message:"Internal Server Error",error:t.t0.message}));case 12:case"end":return t.stop()}}),t,null,[[4,9]])})));return function(e,r){return t.apply(this,arguments)}}(),xe=function(){var t=me(de().mark((function t(e,r){var n,o,i;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body.title,o=e.params.id,n){t.next=4;break}return t.abrupt("return",r.status(400).json({success:!1,message:"title is missing"}));case 4:return i=parseInt(o),console.log(i,n),t.prev=6,t.next=10,a.query("\nUPDATE document\nSET title=$1\nWHERE id=$2\nRETURNING *\n",[n,i]);case 10:if(0!==t.sent.rows.length){t.next=13;break}return t.abrupt("return",r.status(404).json({message:"no document found"}));case 13:return t.abrupt("return",r.status(200).json({message:"updated title success",success:!0}));case 16:return t.prev=16,t.t0=t.catch(6),t.abrupt("return",r.status(500).json({message:"Internal server error",success:!1,error:t.t0}));case 19:case"end":return t.stop()}}),t,null,[[6,16]])})));return function(e,r){return t.apply(this,arguments)}}(),Ee=function(){var t=me(de().mark((function t(e,r){var n,o,i,c,s,u,l,p,f,h,d,y;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.query,i=e.query.title||"",console.log(o,"query is"),c=parseInt(o.page),s=parseInt(o.size),u=Qt(c,s),l=u.limit,p=u.offset,f=(null==o?void 0:o.orderByColumn)||"created_at",h=(null==o||null===(n=o.orderByDirection)||void 0===n?void 0:n.toUpperCase())||"ASC",t.prev=8,d="\nWITH paginated_data AS (\n  SELECT \n    id, \n    convert_from(htmldata, 'utf8') as data, \n    category_id, \n    created_at, \n    created_by, \n    title\n  FROM template\n  WHERE \n  title ILIKE '%'||$3||'%'\n  ORDER BY ".concat(f," ").concat(h,"\n  LIMIT $1 OFFSET $2\n),\ntotal_count AS (\n  SELECT COUNT(*) as total_count FROM document\n)\nSELECT \n  pd.*\n  , \n  (SELECT total_count FROM total_count) as total_count\nFROM \n  paginated_data pd;\n"),t.next=12,a.query(d,[l,p,i]);case 12:if(0!==(y=t.sent).rowCount){t.next=15;break}return t.abrupt("return",r.status(404).json({success:!1,message:"no templates found"}));case 15:return console.log(y.rowCount),t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:y.rows}));case 19:return t.prev=19,t.t0=t.catch(8),t.abrupt("return",r.status(500).json({message:"Internal server error",error:t.t0,success:!1}));case 22:case"end":return t.stop()}}),t,null,[[8,19]])})));return function(e,r){return t.apply(this,arguments)}}(),Le=function(){var t=me(de().mark((function t(e,r){var n;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=4,a.query("SELECT id,  \n    mode, \n    created_at, \n    created_by, \n    title\n    FROM template ORDER by created_at DESC ");case 4:if(0!==(n=t.sent).rowCount){t.next=7;break}return t.abrupt("return",r.status(404).json({success:!1,message:"no templates found"}));case 7:return console.log(n.rowCount),t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:n.rows}));case 11:return t.prev=11,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({message:"Internal server error",error:t.t0,success:!1}));case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,r){return t.apply(this,arguments)}}(),_e=function(){var t=me(de().mark((function t(e,r){var n,o;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.params.status,console.log(n),t.next=5,a.query("SELECT id,  \n      mode, \n      created_at, \n      created_by, \n      title\n      FROM template WHERE mode = $1 ORDER by created_at DESC  ",[n]);case 5:if(0!==(o=t.sent).rowCount){t.next=8;break}return t.abrupt("return",r.status(404).json({success:!1,message:"no templates found"}));case 8:return console.log(o.rowCount),t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:o.rows}));case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({message:"Internal server error",error:t.t0,success:!1}));case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),je=function(){var t=me(de().mark((function t(e,r){var n;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=4,a.query("\n    SELECT \n    d.id, \n\td.title,\n    d.category_id as cid,\n    d.created_at,\n\tu.first_name\n  FROM document d\n\n  JOIN user_table u ON d.created_by =u.id\n  where d.is_active = TRUE\n  ORDER BY d.created_at DESC\n  LIMIT 5;\n");case 4:if(0!==(n=t.sent).rowCount){t.next=7;break}return t.abrupt("return",r.status(404).json({success:!1,message:"no document dound"}));case 7:return t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:n.rows}));case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({message:"Internal server error",error:t.t0,success:!1}));case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r){return t.apply(this,arguments)}}(),ke=function(){var t=me(de().mark((function t(e,r){var n,o,i,c,s,u,l,p,f,h,d;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.query,i=parseInt(o.page),c=parseInt(o.size),s=Qt(i,c),u=s.limit,l=s.offset,console.log(u,l),p=(null==o?void 0:o.orderByColumn)||"created_at",f=(null==o||null===(n=o.orderByDirection)||void 0===n?void 0:n.toUpperCase())||"DESC",t.prev=7,h="\nWITH paginated_data AS (\n  SELECT \n    id, \n    category_id as cid,\n    htmljson, \n    convert_from(htmldata, 'utf8') as data,  \n    created_at, \n    created_by, \n    title\n  FROM document d\n  ORDER BY ".concat(p," ").concat(f,"\n  LIMIT $1 OFFSET $2\n),\ntotal_count AS (\n  SELECT COUNT(*) as total_count FROM document\n)\nSELECT \n  pd.*, \n  (SELECT total_count FROM total_count) as total_count\nFROM \npaginated_data pd;\n"),t.next=11,a.query(h,[u,l]);case 11:if(0!==(d=t.sent).rows.length){t.next=14;break}return t.abrupt("return",r.status(404).json({success:!1,message:"no document dound"}));case 14:return console.log(d.rows.length),t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:d.rows}));case 18:return t.prev=18,t.t0=t.catch(7),t.abrupt("return",r.status(500).json({message:"Internal server error",error:t.t0,success:!1}));case 21:case"end":return t.stop()}}),t,null,[[7,18]])})));return function(e,r){return t.apply(this,arguments)}}(),Ae=function(){var t=me(de().mark((function t(e,r,n){var o,a,i,c;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.user.id,console.log(e.user),a=e.body,i=a.htmlText,a.htmlJson,a.categoryId,a.title,console.log(i),!(Buffer.byteLength(i,"utf8")>10485760)){t.next=7;break}return t.abrupt("return",r.status(400).json({success:!1,message:"File size should be less than 10MB"}));case 7:if(void 0!==i){t.next=9;break}return t.abrupt("return",r.status(400).json({success:!1,message:"File not uploaded,Invalid input"}));case 9:return t.prev=9,t.next=12,ie(e.body,o);case 12:return c=t.sent,t.abrupt("return",r.status(201).json({success:!0,message:"File uploaded",document:c}));case 16:t.prev=16,t.t0=t.catch(9),n(t.t0);case 19:case"end":return t.stop()}}),t,null,[[9,16]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Se=function(){var t=me(de().mark((function t(e,r,n){var o,i,c;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.body.docDetail,console.log(o,"doc Deatil is"),t.prev=2,i=o.map((function(t){return"(".concat(parseInt(t.categoryId),",'").concat(t.title.toString(),"',").concat(parseInt(t.docId),")")})),console.log(i.join(",")),c={text:"UPDATE document AS d\n    SET \n    category_id=c.category_id,\n    title=c.title\n  FROM (\n    VALUES \n    ".concat(i.join(","),"\n  ) AS c(category_id,title,doc_id)\n  WHERE d.id = c.doc_id\n")},t.next=8,a.query(c);case 8:return t.sent,t.abrupt("return",r.status(200).json({message:"document upload success"}));case 12:t.prev=12,t.t0=t.catch(2),n(t.t0);case 15:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Oe=function(){var t=me(de().mark((function t(e,r,n){var o,i,c,s,u,l,p,f,h,d;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.query,i=e.query.name||"",c=e.query.template||"",s=e.query.status?e.query.status.split(","):[],console.log(s),u=parseInt(o.page)||0,l=parseInt(o.size)||5,p=Qt(u,l),f=p.limit,h=p.offset,console.log("page",f,h),console.log(i.toString(),c.toString(),"SADA"),t.prev=10,t.next=14,a.query("\n    WITH paginated_data AS (\n      SELECT \n        l.id, \n        l.template_id AS tid,\n        l.filepath,   \n        l.created_at, \n        l.created_by,\n        l.status,\n        l.recipient_name AS rname,\n        l.recipient_email AS remail,\n        CONCAT(us.first_name, ' ', us.last_name) AS employee_name,\n        COUNT(*) OVER() AS total_count\n      FROM letters l\n      JOIN user_table us \n        ON us.id = l.userid\n      WHERE l.status = ANY($1)\n    )\n    SELECT \n      pd.*, \n      t.title AS template_name, CONCAT(ut.first_name, ' ', ut.last_name) as created_by_name, c.category\n    FROM \n      paginated_data pd\n\tJOIN user_table ut\n\ton pd.created_by= ut.id\n    JOIN template t\n      ON pd.tid = t.id\n\n    JOIN category c \n      ON t.category_id = c.id\n    ORDER BY created_at DESC\n    LIMIT $2 OFFSET $3;\n    \n",[s,f,h]);case 14:if(d=t.sent,console.log(d.rows,"letters are"),0!==d.rows.length){t.next=18;break}throw new L("no document found");case 18:return console.log(d.rows.length),t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:d.rows}));case 22:t.prev=22,t.t0=t.catch(10),n(t.t0);case 25:case"end":return t.stop()}}),t,null,[[10,22]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ce=function(){var t=me(de().mark((function t(e,r,n){var o,i;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.params.id,t.prev=1,t.next=4,a.query("SELECT convert_from(html_data,'utf8') as html_data,recipient_name,recipient_email,userid as recipientId,template_id,id as letter_id FROM letters where id=$1",[o]);case 4:if(i=t.sent,console.log(i.rows[0]),0!==i.rows.length){t.next=8;break}throw new L("no document found");case 8:return console.log(i.rows.length),t.abrupt("return",r.status(200).json({message:"documents are",success:!0,data:i.rows[0]}));case 12:t.prev=12,t.t0=t.catch(1),n(t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Te=function(){var t=me(de().mark((function t(e,r,n){var o,a,i;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.body,a=o.ShareLink,i=o.userId,t.prev=1,t.prev=2,t.next=5,pool2.query('INSERT INTO "Document" ("userId","ShareLink") VALUES (\''.concat(i,"','").concat(a,"')"));case 5:t.sent,t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(2),new x("something wrong with db");case 11:return t.abrupt("return",r.status(200).json({message:"documents are",success:!0}));case 14:t.prev=14,t.t1=t.catch(1),n(t.t1);case 17:case"end":return t.stop()}}),t,null,[[1,14],[2,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ie=function(){var t=me(de().mark((function t(e,r,n){var o,a;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.file),o=e.file.originalname,console.log("file upload minio hit"),t.prev=3,t.next=6,fe.putObject("ipvms-dev",o,e.file.buffer,function(){var t=me(de().mark((function t(e,r){return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}throw console.log(e),new x("error in uplaoding to minio");case 5:return t.next=7,fe.presignedGetObject("ipvms-dev",o,604800,(function(t,e){if(t)throw console.log(t.message),new x("error in getting file");a=e}));case 7:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}());case 6:return t.abrupt("return",r.status(200).json({message:"documents are",success:!0,url:a}));case 9:t.prev=9,t.t0=t.catch(3),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ne=function(){var t=me(de().mark((function t(e,r,n){var o,a;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.params.userId){t.next=3;break}return t.abrupt("return",new E("user id is null"));case 3:return t.prev=3,t.next=6,se(o);case 6:return a=t.sent,t.abrupt("return",r.status(200).json({message:"All Letter send to user are",letter:a.rows}));case 10:t.prev=10,t.t0=t.catch(3),n(t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e,r,n){return t.apply(this,arguments)}}();function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Re(){Re=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Pe(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Pe(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Fe(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function qe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Fe(a,n,o,i,c,"next",t)}function c(t){Fe(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Ge=function(){var t=qe(Re().mark((function t(e,r,n){var o,a,i;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.body,a=o.htmlText,i=o.docId,i=parseInt(i),a||n(new E("html text required")),i||n(new E("doc id required")),Buffer.byteLength(a,"utf8")>10485760&&n(new E("File size should be less than 10MB")),n();case 7:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),Me=function(){var t=qe(Re().mark((function t(e,r,n){var o;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.params.docId,(o=parseInt(o))||n(new E("doc id required")),n();case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),Ue=function(){var t=qe(Re().mark((function t(e,r,n){var o;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.params.id,(o=parseInt(o))||n(new E("id required")),n();case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),De=function(){var t=qe(Re().mark((function t(e,r,n){var o,a;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(o=e.body).name,o.description,o.categoryId,a=o.htmlText,Buffer.byteLength(a,"utf8")>10485760&&n(new E("File size should be less than 10MB")),n();case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),He=function(){var t=qe(Re().mark((function t(e,r,n){var o,a,i,c;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.body,a=o.version_number,i=o.doc_id,c=o.delta,o.created_by,a&&""!==a||n(new E("version_number or doc_id or delta are missing")),i&&""!==i||n(new E("version_number or doc_id or delta are missing")),c&&""!==c&&0!==Object.keys(c).length||n(new E("version_number or doc_id or delta are missing")),n();case 5:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}();function Ve(t){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ve(t)}function Be(){Be=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Ve(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ve(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function ze(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function We(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ze(a,n,o,i,c,"next",t)}function c(t){ze(a,n,o,i,c,"throw",t)}i(void 0)}))}}var $e=function(){var t=We(Be().mark((function t(e,r,n,o){var i,c;return Be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=[e,parseInt(r),n,o],t.prev=2,t.next=5,a.query("\n      INSERT INTO document_version(version_number, doc_id, delta, created_by)\n      VALUES($1, $2, $3, $4)\n      RETURNING *;\n    ",i);case 5:c=t.sent,console.log(c),t.next=13;break;case 9:throw t.prev=9,t.t0=t.catch(2),console.log(t.t0.message,"rg"),new x("cant set version ");case 13:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e,r,n,o){return t.apply(this,arguments)}}(),Ze=function(){var t=We(Be().mark((function t(e,r,n,o){var i,c;return Be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("in serviuce",e,r),i=[parseFloat(e),parseInt(r),n,o],t.prev=3,t.next=6,a.query("\n      INSERT INTO template_version(version_number, doc_id, delta, created_by)\n      VALUES($1, $2, $3, $4)\n      RETURNING *;\n    ",i);case 6:c=t.sent,console.log(c),t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(3),console.log(t.t0.message,"rg"),new x("cant set version ");case 14:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e,r,n,o){return t.apply(this,arguments)}}();function Je(t){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Je(t)}function Ye(){Ye=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Je(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Je(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Xe(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Ke(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Xe(a,n,o,i,c,"next",t)}function c(t){Xe(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Qe=o.resolve();n.config({path:o.resolve(Qe,"../../../.env")});var tr=function(){var t=Ke(Ye().mark((function t(e,r,n){var o,a,i,c,s;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.body,a=o.version_number,i=o.doc_id,c=o.delta,s=o.created_by,t.next=4,$e(a,i,c,s);case 4:return t.sent,t.abrupt("return",r.status(201).json({success:!0,message:"Document version created:"}));case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),er=function(){var t=Ke(Ye().mark((function t(e,r,n){var o,a;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(e.query),o=parseInt(e.query.docId),console.log(o),t.next=6,versioncontrol.getDocumentVersionsDatewiseService({docId:o});case 6:return a=t.sent,t.abrupt("return",r.status(200).json({status:"success",message:"Document version:",length:a.length,data:a.rows}));case 10:t.prev=10,t.t0=t.catch(0),n(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r,n){return t.apply(this,arguments)}}(),rr=function(){var t=Ke(Ye().mark((function t(e,r,n){var o,a;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=parseInt(e.query.id),t.next=4,versioncontrol.getDocumentVersionsByIdService({docId:o});case 4:return a=t.sent,t.abrupt("return",r.status(200).json({status:"success",message:"Document version:",length:a.length,data:a.rows[0]}));case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),nr=function(){var t=Ke(Ye().mark((function t(e,r,n){var o;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ce(e);case 3:return o=t.sent,t.abrupt("return",r.status(200).json({message:"documents are",success:!0,length:o.length,data:o.rows}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}();const or=require("multer");var ar=or({storage:or.memoryStorage(),limits:{fileSize:"2mb"},fileFilter:function(t,e,r){if(!["application/pdf"].includes(e.mimetype))return console.log(e.mimetype,"mime type"),r(new E("file should be pdf format"));r(null,!0)}});require("console");var ir="POLICY";function cr(t){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cr(t)}function sr(){sr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==cr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(cr(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function ur(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function lr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ur(a,n,o,i,c,"next",t)}function c(t){ur(a,n,o,i,c,"throw",t)}i(void 0)}))}}var pr=function(){var t=lr(sr().mark((function t(e,r,n){return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,console.log("direct message",r,n),t.next=5,a.query(" INSERT INTO notification (notification_object_id, notifier_id, status)\nVALUES ($1, $2, $3)\nRETURNING *",[e,r,n]);case 5:t.sent,t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(1),new x("error in creating notification");case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),fr=function(){var t=lr(sr().mark((function t(e,r,n){return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,a.query(" INSERT INTO notification (notification_object_id,broadcast_id, status,broadcast,notifier_id)\n  VALUES ($1, $2, $3,$4,$5)\n  RETURNING *",[e,r,n,!0,0]);case 4:t.sent,t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(1),console.log(t.t0),new x("error in creating notification");case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,r,n){return t.apply(this,arguments)}}(),hr=function(){var t=lr(sr().mark((function t(e,r,n,o){var i;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,a.query("INSERT INTO notification_object (entity_type,entity_id,status,entity_group)\n    VALUES ($1, $2, $3,$4)\n    RETURNING * ",[e,r,n,o]);case 4:return i=t.sent,t.abrupt("return",i.rows[0].id);case 8:throw t.prev=8,t.t0=t.catch(1),console.log(t.t0),new x("error in creating notification");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,r,n,o){return t.apply(this,arguments)}}(),dr=function(){var t=lr(sr().mark((function t(e,r){var n;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,a.query("INSERT INTO notification_change (notification_object_id,actor_id)\n    VALUES ($1, $2)\n    RETURNING * ",[e,r]);case 4:return n=t.sent,t.abrupt("return",n.rows[0].id);case 8:throw t.prev=8,t.t0=t.catch(1),console.log(t.t0),new x("error in creating notification");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,r){return t.apply(this,arguments)}}(),yr=function(){var t=lr(sr().mark((function t(e,r){var n;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,a.query("\n  SELECT \n    n.*, \n    CASE \n        WHEN no.entity_group LIKE 'LETTER' THEN l.filepath \n        WHEN no.entity_group LIKE 'POLICY' THEN p.title\n        ELSE 'Unknown Entity'\n    END AS entity_name,\n    no.entity_type, \n    no.entity_id,\n    nc.actor_id,\n    u.first_name,\n    u.last_name\nFROM \n    notification n\nJOIN \n    notification_object no ON n.notification_object_id = no.id\nJOIN\n    notification_change nc ON n.notification_object_id = nc.notification_object_id\nJOIN\n    user_table u ON nc.actor_id = u.id\nLEFT JOIN\n    letters l ON no.entity_id = l.id AND no.entity_group = 'LETTER'\nLEFT JOIN\n    document p ON no.entity_id = p.id AND no.entity_group = 'POLICY'\nWHERE \n    (n.notifier_id = $1 OR n.broadcast = true)\n    OR\n    (n.broadcast = true AND n.broadcast_id=$2)\nORDER BY \n    n.id DESC;\n  ",[e,r]);case 4:return n=t.sent,console.log("notification are",n.rows),t.abrupt("return",n.rows);case 9:throw t.prev=9,t.t0=t.catch(1),console.log(t.t0),new x("some error in getting notification");case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}(),mr=function(){var t=lr(sr().mark((function t(e,r,n,o,a){var i,c,s=arguments;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>5&&void 0!==s[5]?s[5]:null,t.prev=1,t.next=4,hr(e,r,1,n);case 4:return c=t.sent,t.next=7,dr(c,a);case 7:if(null===i){t.next=12;break}return t.next=10,fr(c,i,1);case 10:t.next=14;break;case 12:return t.next=14,pr(c,o,1);case 14:return t.abrupt("return","Notification generated successfully");case 17:throw t.prev=17,t.t0=t.catch(1),console.error("Error generating notification:",t.t0.message),t.t0;case 21:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e,r,n,o,a){return t.apply(this,arguments)}}();function vr(t){return vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr(t)}function gr(){gr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==vr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(vr(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function br(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function wr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){br(a,n,o,i,c,"next",t)}function c(t){br(a,n,o,i,c,"throw",t)}i(void 0)}))}}o.resolve();var xr=function(){var t=wr(gr().mark((function t(e,r,n){var o,i,c,s,u,l,p,f,h,d,y,m;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("hit upload"),t.prev=1,o=e.file.originalname,i=e.body.templateId,c=e.body.userId,console.log("userrrr id is",c),s=e.body.email,u=e.body.ipvms_userId,l=e.body.recipient_name,p=e.body.recipient_email,t.prev=10,t.next=13,fe.putObject("ipvms-dev",o,e.file.buffer,function(){var t=wr(gr().mark((function t(e,r){return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=3;break}throw console.log(e),new x("error in uplaoding to minio");case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}());case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(10),new x;case 18:if(t.prev=18,d=e.body.html_data,y=e.body.letter_id||-1,console.log(s),console.log("letter id is",y),m=Buffer.from(d,"utf8"),console.log(vr(y),"tyoe is letter id"),-1!==y){t.next=32;break}return console.log("letter id not call"),t.next=29,a.query("INSERT INTO letters (template_id,userid,html_data,status,filepath,recipient_email,recipient_name,created_by) VALUES($1,$2,$3,$4,$5,$6,$7,$8) RETURNING *",[i,c,m,"PENDING",o,p,l,u]);case 29:f=t.sent,t.next=36;break;case 32:return console.log("letter id is",y),t.next=35,a.query("UPDATE  letters SET status=$1,filepath=$2  WHERE id=$3 RETURNING *",["PENDING",o,y]);case 35:f=t.sent;case 36:return t.next=38,mr("201",null===(h=f)||void 0===h||null===(h=h.rows[0])||void 0===h?void 0:h.id,"LETTER",c,u);case 38:t.next=44;break;case 40:throw t.prev=40,t.t1=t.catch(18),console.log(t.t1),new x("some error in saving letter in db");case 44:return t.prev=44,console.log("Sending email",s),t.next=48,F(e.file,s);case 48:t.next=53;break;case 50:throw t.prev=50,t.t2=t.catch(44),t.t2;case 53:return t.abrupt("return",r.status(200).json({message:"pdf send success",success:!0}));case 56:t.prev=56,t.t3=t.catch(1),n(t.t3);case 59:case"end":return t.stop()}}),t,null,[[1,56],[10,15],[18,40],[44,50]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Er=function(){var t=wr(gr().mark((function t(e,r,n){var o;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.params.id,t.prev=1,void 0!==o){t.next=4;break}throw new E("id is not defined");case 4:return t.prev=4,t.next=7,a.query("DELETE FROM letters where id=$1",[o]);case 7:return t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"successfull"}));case 11:throw t.prev=11,t.t0=t.catch(4),console.log(t.t0.message,"error"),new x("some error in db query");case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(1),n(t.t1);case 20:case"end":return t.stop()}}),t,null,[[1,17],[4,11]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Lr=function(){var t=wr(gr().mark((function t(e,r,n){var o,a;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.params.filename,a="",t.prev=2,t.next=5,fe.presignedGetObject("ipvms-dev",o,3600,(function(t,e){if(t)throw console.log(t.message),new x("error in getting file");a=e}));case 5:return t.abrupt("return",r.status(200).json({message:"get url success",url:a}));case 8:t.prev=8,t.t0=t.catch(2),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),_r=function(){var t=wr(gr().mark((function t(e,r,n){var o,i,c,s,u,l,p,f,h;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("hit upload"),t.prev=1,o=e.body,i=o.recipientId,c=o.templateId,s=o.html_data,u=o.letter_id,l=o.createdby,p=o.email,f=o.name,h=Buffer.from(s,"utf8"),console.log(s,"html data is"),u?a.query("UPDATE  letters SET html_data=$1 WHERE id=$2",[h,u]):a.query("INSERT INTO letters (template_id,userid,html_data,created_by,recipient_name,recipient_email) VALUES($1,$2,$3,$4,$5,$6)",[c,i,h,l,f,p]),t.abrupt("return",r.status(201).json({message:"Letter added successfully",success:!0}));case 9:t.prev=9,t.t0=t.catch(1),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r,n){return t.apply(this,arguments)}}(),jr=function(){var t=wr(gr().mark((function t(e,r,n){var o,i,c,s,u,l,p,f,h,d;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.body.htmlData,i=Buffer.from(o,"utf8"),c=e.body.letterId,s=e.body.createdBy,u=e.body.recipientId,l=e.body.templateId,p=e.body.name,f=e.body.email,h=e.body.fileName,d=e.body.swift_id,e.body.ShareLink,console.log("fileName is",h),void 0!==c?a.query("UPDATE  letters SET html_data=$1,status=$3,swift_id=$4,filepath=$5 WHERE id=$2",[i,c,"PENDING",d,h]):a.query("INSERT INTO  letters (html_data,status,created_by,userid,template_id,recipient_name,recipient_email,swift_id,filepath) VALUES($1,$2,$3,$4,$5,$6,$7,$8,$9)",[i,"PENDING",s,u,l,p,f,d,h]),t.abrupt("return",r.status(200).json({message:"success",success:!0}));case 17:t.prev=17,t.t0=t.catch(0),n(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,r,n){return t.apply(this,arguments)}}(),kr=function(){var t=wr(gr().mark((function t(e,r,n){var o,i;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.params.id,console.log(o,"user iddd is"),t.next=5,a.query("SELECT l.status ,u.first_name as firstname ,l.recipient_name as name,l.recipient_email as email,u.last_name as lastname from letters l JOIN user_table u ON u.id=l.userid  where created_by=$1",[o]);case 5:return i=t.sent,console.log("wered user id",i.rows),t.abrupt("return",r.status(200).json({message:"All queue letters are",data:i.rows}));case 10:t.prev=10,t.t0=t.catch(0),n(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ar=function(){var t=wr(gr().mark((function t(e,r,n){var o;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.params.id,console.log(o,"Swift id is"),t.prev=2,t.next=5,a.query("UPDATE letters SET status=$1 where swift_id=$2",["SIGNED",o]);case 5:return t.abrupt("return",r.status(200).json({success:!0,message:"succesully updated status"}));case 8:t.prev=8,t.t0=t.catch(2),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Sr=t.Router();Sr.post("/uploadFile",Ge,ve),Sr.post("/createPolicy",Gt,Ae),Sr.post("/setPolicyDetail",Se),Sr.get("/getFile/:docId",ge),Sr.get("/getLetters",Oe),Sr.get("/getLetter/:id",Ce),Sr.post("/saveLetter",_r),Sr.post("/uploadTemplate",Gt,De,be),Sr.get("/getTemplateById/:id",we),Sr.post("/updateDocument/:id",xe),Sr.get("/getTemplate",Ee),Sr.get("/getAllTemplate",Le),Sr.get("/getTemplateByStatus/:status",_e),Sr.get("/getpaginateddocuments",ke),Sr.get("/getRecentPolicies",je),Sr.get("/document",nr),Sr.post("/uploadLetter",ar.single("file"),xr),Sr.get("/getLetterUrl/:filename",Lr),Sr.post("/upload/signswift",Te),Sr.post("/upload/letterpdf",ar.single("file"),Ie),Sr.post("/upload/updateLetterStatus",jr),Sr.get("/letter/:id",kr),Sr.delete("/deleteLetter/:id",Er),Sr.get("/getSendletter/:userId",Ne);const Or=Sr,Cr=(require("express-rate-limit"),require("swagger-ui-express"));function Tr(t){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tr(t)}function Ir(t,e,r){var n;return n=function(t,e){if("object"!=Tr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=Tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==Tr(n)?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Nr={openapi:"3.0.1",info:{version:"1.3.0",title:"IPVMS api descriptions",description:"Description of api",termsOfService:"https://mysite.com/terms",contact:{name:"Developer name",email:"dev@example.com",url:"https://devwebsite.com"},license:{name:"Apache 2.0",url:"https://www.apache.org/licenses/LICENSE-2.0.html"}},servers:[{url:"http://127.0.0.1:5001",description:"Local Server"},{url:"http://ipvms-api.exitest.com",description:"Production Server"}],tags:[{name:"Roles"},{name:"Users"},{name:"Category"},{name:"Documents"},{name:"Templates"}],paths:{"/api/user/registerUser":{post:{tags:["Users"],description:"Create a new use in the system",operationId:"registerUser",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/registerUserBody"}}},required:!0},responses:{201:{description:"User created successfully!",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"User Registered"},data:{type:"object",properties:{id:{type:"string",example:"60564fcb544047cdc3844818"},first_name:{type:"string",example:"John"},last_name:{type:"string",example:"snow"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},updated_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},email:{type:"string",example:"Tarora@ex2india.com"},is_active:{type:"boolean",example:!0},password_reset:{type:"boolean",example:!0}}}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Internal Server Error"}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Invalid format"}}}}}},409:{description:"Conflict",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"User Email Already Exist"}}}}}}}}},"/api/user/loginUser":{post:{tags:["Users"],description:"Login new User in the system",operationId:"loginUser",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/loginUserBody"}}},required:!0},responses:{200:{description:"User logged in successfully!",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"Login Success"},token:{type:"string",example:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"},data:{type:"object",properties:{id:{type:"string",example:"60564fcb544047cdc3844818"},first_name:{type:"string",example:"John"},last_name:{type:"string",example:"snow"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},updated_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},email:{type:"string",example:"Tarora@ex2india.com"},is_active:{type:"boolean",example:!0},password_reset:{type:"boolean",example:!0}}}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Internal Server Error"}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Invalid format"}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"user not found"}}}}}},401:{description:"Unauthorized",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Invalid Credentials"}}}}}}}}},"/api/user/getAllUsers":{get:{tags:["Users"],description:"get All User in the system",operationId:"getAllUsers",security:[{bearerAuth:[]}],responses:{200:{description:"get All Users Succeess",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"all user are"},data:{type:"array",items:{type:"object",properties:{id:{type:"string",example:"60564fcb544047cdc3844818"},first_name:{type:"string",example:"John"},last_name:{type:"string",example:"snow"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},updated_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},email:{type:"string",example:"Tarora@ex2india.com"},is_active:{type:"boolean",example:!0},password_reset:{type:"boolean",example:!0}}}}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Internal Server Error"}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Invalid format"}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"user not found"}}}}}}}}},"/api/user/forgotPassword":{post:{tags:["Users"],description:"forgot password",operationId:"forgotPassword",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/forgotUserBody"}}},required:!0},responses:{200:{description:"forgot Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"mail is sent to the registered mail id"},secretToken:{type:"string",example:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Internal Server Error"}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Invalid format"}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"user not found"}}}}}},502:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"can't send email"}}}}}}}}},"/api/user/resetPassword/{token}":{post:{tags:["Users"],description:"for reset password after mail send",operationId:"resetPassword",security:[{bearerAuth:[]}],parameters:[{name:"token",in:"path",required:!0,schema:{type:"string"},description:"Token for user authentication"}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/resetUserBody"}}},required:!0},responses:{200:{description:"reset Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"reset password success"},user:Ir(Ir({type:"object"},"type","object"),"properties",{id:{type:"string",example:"60564fcb544047cdc3844818"},first_name:{type:"string",example:"John"},last_name:{type:"string",example:"snow"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},updated_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},email:{type:"string",example:"Tarora@ex2india.com"},is_active:{type:"boolean",example:!0},password_reset:{type:"boolean",example:!0}}),token:{type:"string",example:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in reseting user password"}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in reseting User password"}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"user not found"}}}}}}}}},"/api/user/resetPassword":{post:{tags:["Users"],description:"for reset password of logged in user",operationId:"resetPasswordAuth",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/resetAuthUserBody"}}},required:!0},responses:{200:{description:"reset Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"mail is sent to the registered mail id"},user:Ir(Ir({type:"object"},"type","object"),"properties",{id:{type:"string",example:"60564fcb544047cdc3844818"},first_name:{type:"string",example:"John"},last_name:{type:"string",example:"snow"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},updated_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},email:{type:"string",example:"Tarora@ex2india.com"},is_active:{type:"boolean",example:!0},password_reset:{type:"boolean",example:!0}}),token:{type:"string",example:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in reseting user password"}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in reseting User password"}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"user not found"}}}}}}}}},"/api/categories/createNewCategory":{post:{tags:["Category"],description:"Create a new category in the system",operationId:"createNewCategory",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/registerCategoryBody"}}},required:!0},responses:{201:{description:"Category created successfully!",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"Category Registered"},data:{type:"object",properties:{id:{type:"number",example:"980765"},category:{type:"string",example:"IT"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},is_active:{type:"boolean",example:!0},svg:{type:"string",example:null},color:{type:"string",example:null}}}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Error in creating Category"}}}}}},409:{description:"Conflict",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Category already Exists"}}}}}},400:{description:"bad request",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Category name required"}}}}}}}}},"/api/categories/getAllCategories":{get:{tags:["Category"],description:"Get All Categories in the system",operationId:"getAllCategories",security:[{bearerAuth:[]}],responses:{200:{description:"Get All Categories Succeess",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"All Categories are :"},length:{type:"number",example:8},data:{type:"array",items:{type:"object",properties:{id:{type:"number",example:"4818"},category:{type:"string",example:"IT"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},is_active:{type:"boolean",example:!0},svg:{type:"string",example:""},color:{type:"sting",example:"#0C3D99"}}}}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Internal Server Error"}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"No categories exists."}}}}}}}}},"/api/categories/editCategory":{patch:{tags:["Category"],description:"Editing name of category.",operationId:"editCategory",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/editCategoryBody"}}},required:!0},responses:{200:{description:"Editing name of category Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"Updated category:"},length:{type:"number",example:1},data:{type:"object",properties:{id:{type:"number",example:818},category:{type:"string",example:"IT"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},is_active:{type:"boolean",example:!0},svg:{type:"string",example:""},color:{type:"string",example:"#987hj"}}}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Internal Server error happened"}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"id or Category name should not be empty."}}}}}},404:{description:"Not found",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Category not found to update."}}}}}}}}},"/api/versioncontrol/createDocumentVersion":{post:{tags:["Documents"],description:"Create a new version of Document in the system",operationId:"createDocumentVersion",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/createDocumentVersionBody"}}},required:!0},responses:{201:{description:"Category created successfully!",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"Document version created:"},length:{type:"number",example:1},data:{type:"object",properties:{id:{type:"number",example:"980765"},version_number:{type:"number",example:"1.3"},doc_id:{type:"number",example:"4"},delta:{type:"json",example:"{'hioini': 'ninianolanc'}"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},created_by:{type:"number",example:"3"}}}}}}}},400:{description:"Version creation error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"version_number or doc_id or delta are missing"}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Error in Creating Document Versions"}}}}}}}}},"/api/versioncontrol/getDocumentVersionsDatewise?docId=":{get:{tags:["Documents"],description:"Get document versions Datewise to show in editor",operationId:"getDocumentVersionsDatewise",security:[{bearerAuth:[]}],parameters:[{name:"docId",in:"query",required:!0,schema:{type:"string"},description:"Document id to get all version  details of it"}],responses:{200:{description:"reset Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"reset password success"},length:{type:"number",example:3},data:{type:"array",items:{type:"object",properties:{date:{type:"string",example:"2024-04-30T18:30:00.000Z"},grouped_values:{type:"string",example:"[28,1.1,4,2024-05-01 04:54:00.505154,Dev], [26,1.1,4,2024-05-01 04:46:29.035146,Dev]"}}}}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in getting Document Versions details."}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"doc id required"}}}}}}}}},"/api/versioncontrol/getDocumentVersionById?id=":{get:{tags:["Documents"],description:"Get document version",operationId:"getDocumentVersionById",security:[{bearerAuth:[]}],parameters:[{name:"id",in:"query",required:!0,schema:{type:"string"},description:"id to get specific version of document"}],responses:{200:{description:"reset Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"reset password success"},length:{type:"number",example:1},data:{type:"object",properties:{id:{type:"number",example:1},version_number:{type:"number",example:"2.2"},doc_id:{type:"string",example:"2"},delta:{type:"json",example:'\n                                        {"hioini":"ninianolanc"}\n                                        '},created_by:{type:"string",example:"5"},created_at:{type:"string",example:"2024-04-30T23:18:30.263Z"}}}}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in getting Document Version."}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"id required"}}}}}}}},"/api/versioncontrol/createTemplateVersion":{post:{tags:["Templates"],description:"Create a new version of Template in the system",operationId:"createTemplateVersion",security:[{bearerAuth:[]}],requestBody:{content:{"application/json":{schema:{$ref:"#/components/schemas/createTemplateVersionBody"}}},required:!0},responses:{201:{description:"Category created successfully!",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"Template version created:"},length:{type:"number",example:1},data:{type:"object",properties:{id:{type:"number",example:"980765"},version_number:{type:"number",example:"1.3"},doc_id:{type:"number",example:"4"},delta:{type:"json",example:"{'hioini': 'ninianolanc'}"},created_at:{type:"string",example:"2024-04-16T01:05:55.959Z"},created_by:{type:"number",example:"3"}}}}}}}},400:{description:"Version creation error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"version_number or doc_id or delta are missing"}}}}}},500:{description:"Internal Server Error",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!1},message:{type:"string",example:"Internal Server Error"}}}}}}}}},"/api/versioncontrol/getTemplateVersionsDatewise?docId=":{get:{tags:["Templates"],description:"Get document versions Datewise to show in editor",operationId:"getTemplateVersionsDatewise",security:[{bearerAuth:[]}],parameters:[{name:"docId",in:"query",required:!0,schema:{type:"string"},description:"Template id to get all version  details of it"}],responses:{200:{description:"reset Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"reset password success"},length:{type:"number",example:3},data:{type:"array",items:{type:"object",properties:{date:{type:"string",example:"2024-04-30T18:30:00.000Z"},grouped_values:{type:"string",example:"[28,1.1,4,2024-05-01 04:54:00.505154,Dev], [26,1.1,4,2024-05-01 04:46:29.035146,Dev]"}}}}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in getting Template Versions details."}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"doc id required"}}}}}}}}},"/api/versioncontrol/getTemplateVersionById?id=":{get:{tags:["Templates"],description:"Get document version",operationId:"getTemplateVersionById",security:[{bearerAuth:[]}],parameters:[{name:"id",in:"query",required:!0,schema:{type:"string"},description:"id to get specific version of document"}],responses:{200:{description:"reset Password Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",example:!0},message:{type:"string",example:"reset password success"},length:{type:"number",example:1},data:{type:"object",properties:{id:{type:"number",example:1},version_number:{type:"number",example:"2.2"},doc_id:{type:"string",example:"2"},delta:{type:"json",example:'\n                                        {"hioini":"ninianolanc"}\n                                        '},created_by:{type:"string",example:"5"},created_at:{type:"string",example:"2024-04-30T23:18:30.263Z"}}}}}}}}},500:{description:"Database Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"Error in getting Template Version."}}}}}},400:{description:"Validation Error",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",example:"id required."}}}}}}}}},components:{securitySchemes:{bearerAuth:{type:"http",scheme:"bearer",bearerFormat:"JWT"}},schemas:{registerUserBody:{type:"object",properties:{firstName:{type:"string",example:"John"},lastName:{type:"string",example:"Snow"},email:{type:"string",example:"johnsnow@ex2india.com"},password:{type:"string",description:"user's password",example:"Hello@12345",pattern:"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})"}}},loginUserBody:{type:"object",properties:{email:{type:"string",example:"johnsnow@ex2india.com"},password:{type:"string",description:"user's password",example:"Hello@12345",pattern:"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})"}}},forgotUserBody:{type:"object",properties:{email:{type:"string",example:"johnsnow@ex2india.com"}}},resetUserBody:{type:"object",properties:{password:{type:"string",example:"Hello@12345"},confirmPassword:{type:"string",example:"Hello@12345"}}},resetAuthUserBody:{type:"object",properties:{password:{type:"string",example:"Hello@12345"},confirmPassword:{type:"string",example:"Hello@12345"}}},registerCategoryBody:{type:"object",properties:{category:{type:"string",example:"IT"}}},createDocumentVersionBody:{type:"object",properties:{version_number:{type:"string",example:"2.2"},doc_id:{type:"string",example:"2"},delta:{type:"json",example:'{"hioini":"ninianolanc"}'},created_by:{type:"string",example:"5"}}},createTemplateVersionBody:{type:"object",properties:{version_number:{type:"string",example:"2.2"},doc_id:{type:"string",example:"2"},delta:{type:"json",example:'\n            {"hioini":"ninianolanc"}\n            '},created_by:{type:"string",example:"5"}}}}}};function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function Rr(){Rr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Pr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Pr(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Fr(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function qr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Fr(a,n,o,i,c,"next",t)}function c(t){Fr(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Gr=function(){var t=qr(Rr().mark((function t(e){var r,n,o,i,c,s;return Rr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.category,n=e.isActive,o=e.color,i=e.svg,console.log(r,n,o,i),c={text:"INSERT INTO category(category,is_active, color, svg) VALUES($1,$2, $3, $4) RETURNING *",values:[r,n,o,i]},t.prev=3,t.next=6,a.query(c);case 6:return s=t.sent,t.abrupt("return",s);case 10:if(t.prev=10,t.t0=t.catch(3),"23505"!==t.t0.code){t.next=16;break}throw new j("Category already Exists");case 16:throw new x("Error in creating Category ");case 17:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e){return t.apply(this,arguments)}}(),Mr=function(){var t=qr(Rr().mark((function t(){var e;return Rr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.query("SELECT * FROM category WHERE is_active=true;");case 3:return e=t.sent,t.abrupt("return",e);case 7:throw t.prev=7,t.t0=t.catch(0),new x("Error in getting Categories");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),Ur=function(){var t=qr(Rr().mark((function t(e){var r,n,o,i,c;return Rr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.category,n=e.id,o=e.type,t.prev=1,i={},"edit"===o?i={text:"UPDATE category SET  category=($2) WHERE id=($1) RETURNING *",values:[n,r]}:"delete"===o&&(i={text:"UPDATE category SET is_active=FALSE  WHERE id=($1)",values:[n]}),t.next=6,a.query(i);case 6:return c=t.sent,t.abrupt("return",c);case 10:throw t.prev=10,t.t0=t.catch(1),new x;case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}();const Dr=require("random-hex-color-generator");var Hr=['<svg width="30" height="30" viewBox="0 0 36 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M18.03 11.8426C21.0421 11.8426 23.4933 9.39145 23.4933 6.37932C23.4933 3.36719 21.0421 0.916016 18.03 0.916016C15.0178 0.916016 12.5667 3.36719 12.5667 6.37973C12.5667 9.39226 15.0174 11.8426 18.03 11.8426ZM18.03 2.62169C20.1019 2.62169 21.7876 4.30741 21.7876 6.37932C21.7876 8.45123 20.1019 10.1369 18.03 10.1369C15.958 10.1369 14.2723 8.45123 14.2723 6.37932C14.2719 4.30741 15.9576 2.62169 18.03 2.62169Z" fill="white"/>\n    <path d="M20.7349 12.3521H15.0817C11.5506 12.3521 8.67822 15.2244 8.67822 18.7556C8.67822 19.2269 9.05953 19.6082 9.53086 19.6082C10.0022 19.6082 10.3835 19.2269 10.3835 18.7556C10.3835 16.1655 12.4913 14.0577 15.0813 14.0577H20.7345C23.3246 14.0577 25.4323 16.1655 25.4323 18.7556C25.4323 19.2269 25.8136 19.6082 26.285 19.6082C26.7563 19.6082 27.1376 19.2269 27.1376 18.7556C27.1384 15.2244 24.266 12.3521 20.7349 12.3521Z" fill="white"/>\n    <path d="M7.62341 11.6182C9.95522 11.6182 11.8524 9.72109 11.8524 7.38928C11.8524 5.05828 9.95522 3.16113 7.62341 3.16113C5.29241 3.16113 3.39526 5.05828 3.39526 7.38928C3.39526 9.72109 5.29241 11.6182 7.62341 11.6182ZM7.62341 4.86681C9.015 4.86681 10.1467 5.9985 10.1467 7.38928C10.1467 8.78087 9.015 9.91255 7.62341 9.91255C6.23263 9.91255 5.10094 8.78087 5.10094 7.38928C5.10094 5.9985 6.23263 4.86681 7.62341 4.86681Z" fill="white"/>\n    <path d="M10.4568 13.1144C10.4568 12.643 10.0755 12.2617 9.6042 12.2617H5.46609C2.75541 12.2617 0.549072 14.4677 0.549072 17.1787C0.549072 17.6501 0.930375 18.0314 1.40171 18.0314C1.87304 18.0314 2.25434 17.6501 2.25434 17.1787C2.25434 15.4083 3.69523 13.9674 5.46568 13.9674H9.6042C10.0755 13.9674 10.4568 13.5857 10.4568 13.1144Z" fill="white"/>\n    <path d="M28.3769 11.6182C30.7079 11.6182 32.6051 9.72109 32.6051 7.38928C32.6051 5.05828 30.7079 3.16113 28.3769 3.16113C26.0451 3.16113 24.1479 5.05828 24.1479 7.38928C24.1475 9.72109 26.0447 11.6182 28.3769 11.6182ZM28.3769 4.86681C29.7677 4.86681 30.8994 5.9985 30.8994 7.38928C30.8994 8.78087 29.7677 9.91255 28.3769 9.91255C26.9853 9.91255 25.8536 8.78087 25.8536 7.38928C25.8532 5.9985 26.9849 4.86681 28.3769 4.86681Z" fill="white"/>\n    <path d="M30.5342 12.2617H26.3961C25.9248 12.2617 25.5435 12.643 25.5435 13.1144C25.5435 13.5857 25.9248 13.967 26.3961 13.967H30.5342C32.3047 13.967 33.7455 15.4079 33.7455 17.1783C33.7455 17.6497 34.1268 18.031 34.5982 18.031C35.0695 18.031 35.4508 17.6497 35.4508 17.1783C35.4512 14.4677 33.2453 12.2617 30.5342 12.2617Z" fill="white"/>\n    </svg>\n        ','<svg width="30" height="30" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M19.6362 4.37366V5.06786C19.6362 5.45125 19.3254 5.76205 18.942 5.76205C18.5586 5.76205 18.2478 5.45125 18.2478 5.06786V4.37366H12.6942V5.06786C12.6942 5.45125 12.3834 5.76205 12 5.76205C11.6166 5.76205 11.3058 5.45125 11.3058 5.06786V4.37366H5.75229V5.06786C5.75229 5.45125 5.44148 5.76205 5.05809 5.76205C4.6747 5.76205 4.3639 5.45125 4.3639 5.06786V4.37366H2.28131C1.89751 4.37366 1.58712 4.68427 1.58712 5.06786V7.15044H22.413V5.06786C22.413 4.68427 22.1026 4.37366 21.7188 4.37366H19.6362ZM19.6362 2.98527H21.7188C22.8696 2.98527 23.8013 3.9177 23.8013 5.06786V22.2314C23.8013 23.3815 22.8696 24.3139 21.7188 24.3139H2.28131C1.13051 24.3139 0.19873 23.3815 0.19873 22.2314V5.06786C0.19873 3.9177 1.13051 2.98527 2.28131 2.98527H4.3639V0.90269C4.3639 0.519298 4.6747 0.208496 5.05809 0.208496C5.44148 0.208496 5.75229 0.519298 5.75229 0.90269V2.98527H11.3058V0.90269C11.3058 0.519298 11.6166 0.208496 12 0.208496C12.3834 0.208496 12.6942 0.519298 12.6942 0.90269V2.98527H18.2478V0.90269C18.2478 0.519298 18.5586 0.208496 18.942 0.208496C19.3254 0.208496 19.6362 0.519298 19.6362 0.90269V2.98527ZM22.413 8.53883H1.58712V22.2314C1.58712 22.6149 1.89751 22.9255 2.28131 22.9255H21.7188C22.1026 22.9255 22.413 22.6149 22.413 22.2314V8.53883Z" fill="white"/>\n    </svg>\n    ','<svg fill="#ffffff" height="30" width="30" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 283.581 283.581" xml:space="preserve" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M281.384,112.941l-76.8-76.811c-1.406-1.407-3.314-2.197-5.304-2.197c-1.989,0-3.897,0.791-5.304,2.197l-37.244,37.248 c-0.003,0.003-0.006,0.007-0.009,0.01l-17.398,17.398l-12.519-12.519c-0.027-0.028-0.051-0.059-0.078-0.086L89.492,40.935 c-1.406-1.407-3.313-2.197-5.303-2.197c-0.001,0-0.001,0-0.001,0c-1.989,0-3.896,0.79-5.304,2.197L2.197,117.622 c-2.929,2.929-2.929,7.677,0,10.606l37.244,37.249c1.406,1.407,3.314,2.197,5.304,2.197s3.897-0.791,5.304-2.197l7.436-7.436 l7.292,7.292l-5.004,5.004c-2.928,2.928-2.929,7.676-0.001,10.605l60.434,60.456c1.407,1.407,3.315,2.198,5.306,2.198 c1.99,0,3.898-0.791,5.305-2.199l5.001-5.005l11.058,11.059c1.406,1.406,3.314,2.197,5.304,2.197c1.989,0,3.896-0.79,5.304-2.197 l28.128-28.129c0.021-0.021,0.044-0.038,0.064-0.058c0.021-0.02,0.037-0.043,0.059-0.064l17.791-17.792 c0.007-0.007,0.015-0.013,0.021-0.02c0.007-0.007,0.013-0.015,0.02-0.022l17.872-17.873c1.406-1.407,2.196-3.314,2.196-5.304 c0-1.99-0.791-3.897-2.197-5.304l-11.061-11.058l12.103-12.114l11.07,11.067c1.465,1.464,3.384,2.196,5.303,2.196 c1.919,0,3.839-0.732,5.304-2.197l37.23-37.234C284.313,120.617,284.313,115.869,281.384,112.941z M18.107,122.926l66.081-66.081 l26.632,26.638l-5.016,5.016l-53.627,53.63c-0.012,0.012-0.021,0.024-0.032,0.036l-7.4,7.401L18.107,122.926z M125.508,225.486 L75.681,175.64l4.984-4.986c0.007-0.006,0.014-0.012,0.021-0.018c0.007-0.006,0.012-0.014,0.019-0.02l4.974-4.975l49.832,49.833 L125.508,225.486z M152.177,231.541l-5.76-5.76l5.003-5.007c2.927-2.929,2.926-7.676-0.002-10.604l-60.437-60.438 c-1.407-1.407-3.314-2.197-5.304-2.197c-1.989,0-3.897,0.791-5.304,2.197l-4.993,4.994l-7.292-7.292l42.439-42.445l10.893-10.894 l7.297,7.297l-30.779,30.779c-1.407,1.407-2.197,3.314-2.197,5.304c0,1.989,0.791,3.897,2.197,5.304l24.139,24.131 c1.407,1.406,3.314,2.196,5.303,2.196h0.002c1.989-0.001,3.896-0.791,5.303-2.198l30.759-30.774l31.013,31.011 c0.063,0.062,0.131,0.117,0.195,0.177l10.873,10.87l-7.284,7.284l-18.934-18.94c-2.927-2.93-7.676-2.93-10.606-0.002 c-2.929,2.929-2.93,7.677-0.001,10.606l18.936,18.942l-7.268,7.27l-18.939-18.938c-2.928-2.929-7.677-2.928-10.606,0.001 c-2.929,2.929-2.929,7.678,0.001,10.607l18.938,18.936L152.177,231.541z M211.863,139.114l-12.099,12.109l-2.572-2.572 c-0.059-0.059-0.123-0.109-0.184-0.165l-28.265-28.263c-1.406-1.407-3.314-2.197-5.304-2.197c-1.989,0-3.898,0.791-5.304,2.198 l-30.759,30.775l-13.529-13.525l30.767-30.766c0.004-0.004,0.009-0.007,0.013-0.011c0.004-0.004,0.008-0.008,0.012-0.012 l17.398-17.397l6.727,6.725L211.863,139.114z M238.849,144.871L181.595,87.63l-8.951-8.951l26.637-26.639l66.194,66.203 L238.849,144.871z"></path> </g></svg>','<svg width="30" height="30" viewBox="0 0 34 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M2.36424 7.04999L14.0513 1.44769C15.8741 0.589917 17.8845 0.107422 19.8949 0.107422C21.5568 0.107422 23.2188 0.429086 24.7735 1.0188C24.8271 1.0188 24.9075 1.04561 24.9611 1.07241L25.0683 1.12602C25.1219 1.15283 25.1755 1.17963 25.2292 1.20644L30.3222 3.27045C32.4934 4.15502 33.8873 6.21903 33.8873 8.55109V13.5637C33.8873 14.0194 33.5388 14.3678 33.0831 14.3678H29.7861C29.4108 16.6463 27.4272 18.3886 25.0415 18.3886C22.3878 18.3886 20.2166 16.2174 20.2166 13.5637C20.2166 10.91 22.3878 8.73873 25.0415 8.73873C27.4272 8.73873 29.4108 10.4811 29.7861 12.7595H32.279V8.55109C32.279 6.88916 31.2872 5.38807 29.7324 4.77154L25.2292 2.94878C24.0765 5.60251 21.4228 7.39846 18.4742 7.39846H13.1668C12.7111 7.39846 12.3626 7.04999 12.3626 6.5943C12.3626 6.13861 12.7111 5.79015 13.1668 5.79015H18.4742C20.7527 5.79015 22.8167 4.42307 23.7281 2.35907C22.495 1.93018 21.2084 1.71574 19.8681 1.71574C18.0989 1.71574 16.3298 2.11782 14.7215 2.89517L3.06118 8.49748C2.25702 8.89956 1.72091 9.73052 1.72091 10.6419V12.7863H2.87354C3.24882 10.5079 5.23241 8.76553 7.61808 8.76553C10.2718 8.76553 12.443 10.9368 12.443 13.5905C12.443 16.2442 10.2718 18.4154 7.61808 18.4154C5.23241 18.4154 3.24882 16.6731 2.87354 14.3946H0.916752C0.461063 14.3946 0.112595 14.0462 0.112595 13.5905V10.6151C0.112595 9.114 0.997169 7.69332 2.36424 7.04999ZM25.0415 10.347C23.2724 10.347 21.8249 11.7945 21.8249 13.5637C21.8249 15.3328 23.2724 16.7803 25.0415 16.7803C26.8107 16.7803 28.2582 15.3328 28.2582 13.5637C28.2582 11.7945 26.8107 10.347 25.0415 10.347ZM7.61808 16.7803C9.38723 16.7803 10.8347 15.3328 10.8347 13.5637C10.8347 11.7945 9.38723 10.347 7.61808 10.347C5.84893 10.347 4.40144 11.7945 4.40144 13.5637C4.40144 15.3328 5.84893 16.7803 7.61808 16.7803Z" fill="white"/>\n</svg>','<svg width="30" height="30" viewBox="0 0 36 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M18.0298 11.8426C21.042 11.8426 23.4931 9.39145 23.4931 6.37932C23.4931 3.36719 21.042 0.916016 18.0298 0.916016C15.0177 0.916016 12.5665 3.36719 12.5665 6.37973C12.5665 9.39226 15.0173 11.8426 18.0298 11.8426ZM18.0298 2.62169C20.1017 2.62169 21.7875 4.30741 21.7875 6.37932C21.7875 8.45123 20.1017 10.1369 18.0298 10.1369C15.9579 10.1369 14.2722 8.45123 14.2722 6.37932C14.2718 4.30741 15.9575 2.62169 18.0298 2.62169Z" fill="white"/>\n<path d="M20.7349 12.3521H15.0817C11.5506 12.3521 8.67822 15.2244 8.67822 18.7556C8.67822 19.2269 9.05953 19.6082 9.53086 19.6082C10.0022 19.6082 10.3835 19.2269 10.3835 18.7556C10.3835 16.1655 12.4913 14.0577 15.0813 14.0577H20.7345C23.3246 14.0577 25.4323 16.1655 25.4323 18.7556C25.4323 19.2269 25.8136 19.6082 26.285 19.6082C26.7563 19.6082 27.1376 19.2269 27.1376 18.7556C27.1384 15.2244 24.266 12.3521 20.7349 12.3521Z" fill="white"/>\n<path d="M7.62353 11.6182C9.95534 11.6182 11.8525 9.72109 11.8525 7.38928C11.8525 5.05828 9.95534 3.16113 7.62353 3.16113C5.29253 3.16113 3.39539 5.05828 3.39539 7.38928C3.39539 9.72109 5.29253 11.6182 7.62353 11.6182ZM7.62353 4.86681C9.01512 4.86681 10.1468 5.9985 10.1468 7.38928C10.1468 8.78087 9.01512 9.91255 7.62353 9.91255C6.23275 9.91255 5.10106 8.78087 5.10106 7.38928C5.10106 5.9985 6.23275 4.86681 7.62353 4.86681Z" fill="white"/>\n<path d="M10.4567 13.1144C10.4567 12.643 10.0754 12.2617 9.60408 12.2617H5.46596C2.75529 12.2617 0.54895 14.4677 0.54895 17.1787C0.54895 17.6501 0.930253 18.0314 1.40159 18.0314C1.87292 18.0314 2.25422 17.6501 2.25422 17.1787C2.25422 15.4083 3.69511 13.9674 5.46556 13.9674H9.60408C10.0754 13.9674 10.4567 13.5857 10.4567 13.1144Z" fill="white"/>\n<path d="M28.3768 11.6182C30.7078 11.6182 32.6049 9.72109 32.6049 7.38928C32.6049 5.05828 30.7078 3.16113 28.3768 3.16113C26.045 3.16113 24.1478 5.05828 24.1478 7.38928C24.1474 9.72109 26.0446 11.6182 28.3768 11.6182ZM28.3768 4.86681C29.7676 4.86681 30.8992 5.9985 30.8992 7.38928C30.8992 8.78087 29.7676 9.91255 28.3768 9.91255C26.9852 9.91255 25.8535 8.78087 25.8535 7.38928C25.8531 5.9985 26.9848 4.86681 28.3768 4.86681Z" fill="white"/>\n<path d="M30.5343 12.2617H26.3962C25.9249 12.2617 25.5436 12.643 25.5436 13.1144C25.5436 13.5857 25.9249 13.967 26.3962 13.967H30.5343C32.3048 13.967 33.7457 15.4079 33.7457 17.1783C33.7457 17.6497 34.127 18.031 34.5983 18.031C35.0696 18.031 35.4509 17.6497 35.4509 17.1783C35.4513 14.4677 33.2454 12.2617 30.5343 12.2617Z" fill="white"/>\n</svg>\n','\n<svg width="24" height="27" viewBox="0 0 24 27" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0_723_5868)">\n    <path d="M7.35176 12.1659L6.03717 13.4532L10.7231 18.0419L17.9629 10.9519L16.6483 9.66455L10.7231 15.4673L7.35176 12.1659Z" fill="white"/>\n    <path d="M12 0.89209L11.4526 1.28282C8.11118 3.66811 4.7362 4.94477 1.42204 5.07723L0.530518 5.11279V10.6977C0.530518 17.6642 4.99221 24.0248 11.6305 26.5244L11.9977 26.6635L12.3318 26.5386C18.9937 24.0475 23.4695 17.6811 23.4695 10.6977V5.11279L22.578 5.07723C19.2638 4.94477 15.8888 3.66811 12.5475 1.28282L12 0.89209ZM21.6102 10.6977C21.6102 16.8147 17.7627 22.401 12 24.7094C6.23826 22.4015 2.38982 16.8112 2.38982 10.6977V6.83664C5.59958 6.53392 8.82612 5.29193 12 3.13558C15.1739 5.29193 18.4005 6.53392 21.6102 6.83664V10.6977Z" fill="white"/>\n    </g>\n    <defs>\n    <clipPath id="clip0_723_5868">\n    <rect width="23.4975" height="25.7714" fill="white" transform="translate(0.251282 0.89209)"/>\n    </clipPath>\n    </defs>\n    </svg>','\n    <svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M20.0522 23.0769L20.0531 23.0762C20.1817 22.9827 20.2489 22.8256 20.2276 22.6677C20.2276 22.6674 20.2276 22.6671 20.2275 22.6669L19.3237 16.1327C19.2512 15.6618 19.4079 15.1897 19.7367 14.8554L24.3118 10.0987L24.3185 10.0917L24.3185 10.0917C24.4305 9.97752 24.4706 9.8089 24.4208 9.6546L24.4206 9.65403C24.3713 9.50087 24.2408 9.38759 24.0817 9.36028L24.0753 9.35918L24.0753 9.35916L17.5751 8.19962C17.105 8.11928 16.703 7.82147 16.4882 7.39823L16.4736 7.36941L13.3832 1.58951C13.3072 1.44738 13.16 1.35938 12.9998 1.35938C12.849 1.35938 12.7098 1.43726 12.6306 1.56483L12.6174 1.58941L9.50512 7.4103C9.28889 7.82718 8.89001 8.12006 8.42445 8.19963L1.92428 9.35916L1.91784 9.3603L1.91784 9.36028C1.75878 9.38758 1.62829 9.50086 1.57892 9.65403L1.57873 9.65461C1.5289 9.8089 1.56901 9.97751 1.68102 10.0917L1.68827 10.0991L1.68823 10.0992L6.2573 14.8558C6.58593 15.19 6.74249 15.662 6.66998 16.1327L5.76595 22.6683C5.76594 22.6684 5.76592 22.6685 5.76591 22.6686C5.74395 22.8284 5.8112 22.986 5.94034 23.0803C6.07034 23.1745 6.24091 23.1895 6.38574 23.1195L20.0522 23.0769ZM20.0522 23.0769C19.9233 23.1709 19.7541 23.1865 19.6111 23.1185C19.6106 23.1183 19.6101 23.118 19.6096 23.1178L13.6616 20.2324C13.2433 20.0294 12.7558 20.0294 12.3374 20.2323C12.3374 20.2323 12.3374 20.2323 12.3373 20.2324L6.38612 23.1194L20.0522 23.0769Z" stroke="white"/>\n    </svg>','\n    <svg width="30" height="30" viewBox="0 0 38 29" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M11.8809 15.7199L11.8809 15.7199C11.3243 15.5531 10.7486 15.4684 10.1681 15.4684H10.0245C8.96961 15.4684 7.93144 15.7491 7.02134 16.2802L1.22137 19.663C1.22135 19.663 1.22134 19.663 1.22132 19.663C1.00937 19.7865 0.880469 20.0129 0.880469 20.2563V27.874C0.880469 28.1245 1.017 28.3549 1.2364 28.4756L1.23663 28.4757C1.33946 28.5319 1.45326 28.56 1.56645 28.56C1.69498 28.56 1.82239 28.5236 1.93431 28.4533L1.93481 28.453L8.21188 24.4582H17.3879C17.5498 24.4582 17.7074 24.4006 17.831 24.2963L17.8311 24.2962L24.8815 18.3298C25.3963 17.8953 25.6917 17.2585 25.6917 16.5834C25.6917 15.3228 24.6654 14.2965 23.4048 14.2965H23.2337C22.7067 14.2965 22.192 14.4803 21.7856 14.8137L17.4203 18.385C17.2425 17.7156 16.7322 17.1752 16.0414 16.9681C16.0414 16.9681 16.0413 16.9681 16.0413 16.9681L11.8809 15.7199ZM23.9959 17.2823L23.9959 17.2823L17.1368 23.0862H8.01224C7.88158 23.0862 7.75424 23.124 7.64442 23.1929L7.64387 23.1932L2.25243 26.6248V20.6501L7.71216 17.4649C7.71218 17.4649 7.71219 17.4649 7.71221 17.4649C8.413 17.0566 9.21247 16.8404 10.0245 16.8404H10.1681C10.6149 16.8404 11.0587 16.9052 11.487 17.0342L11.4871 17.0343L15.6475 18.2824L15.6476 18.2824C15.9281 18.3664 16.116 18.6192 16.116 18.9121C16.116 19.2752 15.8209 19.5703 15.4577 19.5703H11.5281H11.4281V19.6703V20.8423V20.9423H11.5281H16.216C16.3739 20.9423 16.5275 20.8874 16.6501 20.7873L16.6502 20.7872L22.6541 15.8751C22.8174 15.7419 23.0224 15.6684 23.2337 15.6684H23.4048C23.9092 15.6684 24.3197 16.079 24.3197 16.5834C24.3197 16.854 24.2014 17.1085 23.9959 17.2823Z" fill="white" stroke="white" stroke-width="0.2"/>\n    <path d="M37.0071 0.405884L37.0551 0.318147C37.2747 0.43826 37.4113 0.66882 37.4113 0.919203V8.53695C37.4113 8.78024 37.2825 9.00665 37.0704 9.12962C37.0703 9.12966 37.0702 9.12972 37.0702 9.12977L31.2704 12.513C31.2704 12.5131 31.2704 12.5131 31.2704 12.5131C30.3608 13.0441 29.3221 13.3248 28.2672 13.3248H28.1237C27.5443 13.3248 26.968 13.2402 26.4108 13.0727L22.2504 11.8246C21.5596 11.6175 21.0493 11.0776 20.8719 10.4078L16.5061 13.9796L16.4427 13.9022L16.506 13.9796C16.0985 14.3129 15.5845 14.4968 15.0581 14.4968H14.887C13.6264 14.4968 12.6001 13.4711 12.6001 12.2099C12.6001 11.5354 12.8948 10.8986 13.4102 10.4629L20.4605 4.49777C20.4605 4.49773 20.4606 4.49768 20.4606 4.49764C20.5843 4.39261 20.742 4.33509 20.9038 4.33509H30.0799L36.3563 0.340856L36.3566 0.340698C36.5688 0.206535 36.835 0.197464 37.0552 0.318199L37.0071 0.405884ZM37.0071 0.405884C37.1946 0.508431 37.3113 0.70532 37.3113 0.919203V8.53695C37.3113 8.74497 37.2011 8.93835 37.02 9.04324L37.0071 0.405884ZM21.6415 8.00601L15.6382 12.9176C15.4744 13.0514 15.2687 13.1248 15.0581 13.1248H14.887C14.3826 13.1248 13.972 12.7143 13.972 12.2099C13.972 11.9399 14.0903 11.6853 14.2959 11.5109L21.1549 5.70705H30.2795C30.4098 5.70705 30.5374 5.67 30.6477 5.60011L30.6479 5.6L36.0393 2.16903V8.14316L30.5795 11.3277L30.6299 11.4141L30.5795 11.3277C29.8787 11.7366 29.0793 11.9528 28.2672 11.9528H28.1237C27.6775 11.9528 27.233 11.888 26.8046 11.7596L22.6443 10.5115C22.3637 10.4269 22.1758 10.174 22.1758 9.8806C22.1758 9.51808 22.4708 9.22293 22.834 9.22293H26.7636H26.8636V9.12293V7.95097V7.85097H26.7636H22.0758C21.9178 7.85097 21.7643 7.90588 21.6416 8.00591L21.6415 8.00601Z" fill="white" stroke="white" stroke-width="0.2"/>\n    </svg>'];function Vr(t){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vr(t)}function Br(){Br=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Vr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Vr(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function zr(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Wr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){zr(a,n,o,i,c,"next",t)}function c(t){zr(a,n,o,i,c,"throw",t)}i(void 0)}))}}var $r=function(){var t=Wr(Br().mark((function t(e){var r,n,o,a,i;return Br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.category,t.prev=1,n=(0,Dr.randomHexColor)(),o=Hr[Math.floor(9*Math.random())],t.next=7,Gr({category:r,isActive:!0,color:n,svg:o});case 7:return a=t.sent,i={length:a.rowCount,data:a.rows},t.abrupt("return",i);case 12:throw t.prev=12,t.t0=t.catch(1),t.t0;case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}(),Zr=function(){var t=Wr(Br().mark((function t(){var e,r;return Br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Mr();case 3:if(0==(e=t.sent).rowCount){t.next=9;break}return r={length:e.rowCount,rows:e.rows},t.abrupt("return",r);case 9:throw new L("No categories exists.");case 10:t.next=15;break;case 12:throw t.prev=12,t.t0=t.catch(0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(){return t.apply(this,arguments)}}(),Jr=function(){var t=Wr(Br().mark((function t(e){var r,n,o;return Br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.id,t.prev=2,t.next=5,Ur({id:r,type:"delete"});case 5:if(n=t.sent,console.log(n.rowCount),0==n.rowCount){t.next=12;break}return o={length:n.rowCount,rows:n.rows},t.abrupt("return",o);case 12:throw new L("No Category found to delete.");case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(2),t.t0;case 18:case"end":return t.stop()}}),t,null,[[2,15]])})));return function(e){return t.apply(this,arguments)}}(),Yr=function(){var t=Wr(Br().mark((function t(e){var r,n,o,a,i;return Br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.id,n=e.category,o="edit",""!==n){t.next=4;break}throw E("Category name should not be empty.");case 4:return t.prev=4,t.next=7,Ur({id:r,category:n,type:o});case 7:if(0==(a=t.sent).rowCount){t.next=13;break}return i={length:a.rowCount,rows:a.rows},t.abrupt("return",i);case 13:throw new L("Category not found to update.");case 14:t.next=19;break;case 16:throw t.prev=16,t.t0=t.catch(4),t.t0;case 19:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e){return t.apply(this,arguments)}}();function Xr(t){return Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xr(t)}function Kr(){Kr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Xr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Xr(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Qr(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function tn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Qr(a,n,o,i,c,"next",t)}function c(t){Qr(a,n,o,i,c,"throw",t)}i(void 0)}))}}var en=function(){var t=tn(Kr().mark((function t(e,r,n){var o;return Kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$r(e.body);case 3:return o=t.sent,t.abrupt("return",r.status(201).json({success:!0,message:"Category Registered",length:o.length,data:o.rows}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}(),rn=function(){var t=tn(Kr().mark((function t(e,r,n){var o;return Kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Zr();case 3:return o=t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"All Categories are :",length:o.length,data:o.rows}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}(),nn=function(){var t=tn(Kr().mark((function t(e,r,n){var o;return Kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yr(e.body);case 3:return o=t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"Updated category:",length:o.length,data:o.rows}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}(),on=function(){var t=tn(Kr().mark((function t(e,r,n){var o;return Kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Jr(e.body);case 3:return o=t.sent,t.abrupt("return",r.status(200).json({success:!0,message:"Successfully deleted category",length:o.length,data:""}));case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r,n){return t.apply(this,arguments)}}();function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function cn(){cn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==an(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(an(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function sn(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var un=function(){var t,e=(t=cn().mark((function t(e,r,n){var o;return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(o=e.body.category)&&""!==o||n(new E("category name is required")),n();case 3:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){sn(a,n,o,i,c,"next",t)}function c(t){sn(a,n,o,i,c,"throw",t)}i(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}(),ln=t.Router();ln.post("/createNewCategory",un,en),ln.get("/getAllCategories",rn),ln.patch("/editCategory",Ue,un,nn),ln.patch("/deleteCategory",Ue,on);const pn=ln;function fn(t){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fn(t)}function hn(){hn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==fn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(fn(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function dn(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var yn=function(){var t,e=(t=hn().mark((function t(e,r){var n,o,i,c,s;return hn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.body,o=n.searchString,i=n.category,console.log(o,i),c=null!=i?{text:"SELECT * FROM global_search($1) WHERE category=$2",values:[o,i]}:{text:"SELECT * FROM global_search($1)",values:[o]},console.log(c),t.next=7,a.query(c);case 7:if(!(0!=(s=t.sent).rowCount|null)){t.next=12;break}return t.abrupt("return",r.status(200).json({success:!0,message:"Search results",count:s.rowCount,data:s.rows}));case 12:return t.abrupt("return",r.status(400).json({success:!1,message:"No data found."}));case 13:t.next=19;break;case 15:return t.prev=15,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return",r.status(500).json({success:!1,message:"Internal server error"}));case 19:case"end":return t.stop()}}),t,null,[[0,15]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){dn(a,n,o,i,c,"next",t)}function c(t){dn(a,n,o,i,c,"throw",t)}i(void 0)}))});return function(t,r){return e.apply(this,arguments)}}(),mn=t.Router();mn.post("/search",yn);const vn=mn;function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function bn(){bn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==gn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(gn(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function wn(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function xn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){wn(a,n,o,i,c,"next",t)}function c(t){wn(a,n,o,i,c,"throw",t)}i(void 0)}))}}var En=function(){var t=xn(bn().mark((function t(e,r,n){var o,a,i,c,s;return bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.body,a=o.version_number,i=o.doc_id,c=o.delta,s=o.created_by,t.next=4,Ze(a,i,c,s);case 4:return t.sent,t.abrupt("return",r.status(201).json({success:!0,message:"Document version created:"}));case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),Ln=function(){var t=xn(bn().mark((function t(e,r,n){var o,a;return bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(e.query),o=parseInt(e.query.docId),console.log(o),t.next=6,versioncontrol.getTemplateVersionsDatewiseService({docId:o});case 6:return a=t.sent,t.abrupt("return",r.status(200).json({status:"success",message:"Document version:",length:a.length,data:a.rows}));case 10:t.prev=10,t.t0=t.catch(0),n(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r,n){return t.apply(this,arguments)}}(),_n=function(){var t=xn(bn().mark((function t(e,r,n){var o,a;return bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=parseInt(e.query.id),console.log(o),t.next=5,versioncontrol.getTemplateVersionsByIdService({docId:o});case 5:return a=t.sent,t.abrupt("return",r.status(200).json({status:"success",message:"Document version:",length:a.length,data:a.rows[0]}));case 9:t.prev=9,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n){return t.apply(this,arguments)}}();function jn(t){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jn(t)}function kn(){kn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==jn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(jn(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function An(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Sn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){An(a,n,o,i,c,"next",t)}function c(t){An(a,n,o,i,c,"throw",t)}i(void 0)}))}}var On=o.resolve();n.config({path:o.resolve(On,"../../../.env")});var Cn=function(){var t=Sn(kn().mark((function t(e,r){var n,o,i;return kn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=parseInt(e.query.docId),console.log(n),t.next=5,a.query("SELECT * FROM document_version WHERE doc_id=$1",[n]);case 5:if(o=t.sent,console.log(o),i=o.rows,0!==o.rows.length){t.next=10;break}return t.abrupt("return",r.status(404).json({success:!1,message:"No version Found"}));case 10:return t.abrupt("return",r.status(200).json({status:"success",data:i,message:"User Info"}));case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({success:t.t0.message,message:"Internal Server Error"}));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,r){return t.apply(this,arguments)}}(),Tn=function(){var t=Sn(kn().mark((function t(e,r){var n,o,i;return kn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=parseInt(e.query.docId),console.log(n),t.next=5,a.query("SELECT * FROM template_version WHERE doc_id=$1",[n]);case 5:if(o=t.sent,console.log(o),i=o.rows,0!==o.rows.length){t.next=10;break}return t.abrupt("return",r.status(404).json({success:!1,message:"No version Found"}));case 10:return t.abrupt("return",r.status(200).json({status:"success",data:i,message:"User Info"}));case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({success:t.t0.message,message:"Internal Server Error"}));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,r){return t.apply(this,arguments)}}(),In=t.Router();In.post("/createDocumentVersion",tr),In.get("/getDocumentVersionsDatewise",Me,er),In.get("/getDocumentVersionById",Ue,rr),In.post("/createTemplateVersion",He,En),In.get("/getTemplateVersionsDatewise",Me,Ln),In.get("/getTemplateVersionById",Ue,_n),In.get("/getVersions",Cn),In.get("/getVersionsTemplate",Tn);const Nn=In;var Pn=t.Router();Pn.post("/updateLetterStatus/:id",Ar);const Rn=Pn;var Fn=function(t){var e,r,n=t.entity_type,o=(e=t.user_name,r=t.entity_name,{201:"letter is send by ".concat(e),202:"letter is signed by ".concat(e),301:"".concat(r," is approved by ").concat(e),302:"".concat(r," is rejected by ").concat(e),303:"".concat(r," is send by ").concat(e," for approval"),606:"A new policy update in ".concat(r)})[n];if(o){var a=o.toString();return console.log(a,"message is"),a}return console.error("Invalid entity_type provided"),null};function qn(t){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qn(t)}function Gn(){Gn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==qn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(qn(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Mn(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var Un=t.Router();Un.get("/getNotification/:id",function(){var t,e=(t=Gn().mark((function t(e,r,n){var o,a,i,c;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.params.id,a=e.query.role,t.prev=2,t.next=5,yr(o,a);case 5:return i=t.sent,c=[],i.forEach((function(t){var e=null==t?void 0:t.entity_type,r=null==t?void 0:t.first_name,n=null==t?void 0:t.entity_name;console.log(e,n,r),c.push(Fn({entity_type:e,user_name:r,entity_name:n}))})),console.log(c),t.abrupt("return",r.status(200).json({success:!0,notification:c}));case 12:t.prev=12,t.t0=t.catch(2),n(t.t0);case 15:case"end":return t.stop()}}),t,null,[[2,12]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Mn(a,n,o,i,c,"next",t)}function c(t){Mn(a,n,o,i,c,"throw",t)}i(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}());const Dn=Un;function Hn(t){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hn(t)}function Vn(){Vn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof v?e:v,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=p(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Hn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(e,r,n){var o=f;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Hn(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},_(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Bn(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function zn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Bn(a,n,o,i,c,"next",t)}function c(t){Bn(a,n,o,i,c,"throw",t)}i(void 0)}))}}var Wn=o.resolve();n.config({path:o.resolve(Wn,"./.env")});var $n=t();$n.use(e.json({limit:"50mb"})),$n.use(e.urlencoded({limit:"50mb",extended:!0})),$n.use(r()),$n.use(Vt()),$n.use("/documentation",Cr.serve,Cr.setup(Nr)),$n.use("/api/user",Ht),$n.use("/api/categories",pn),$n.use("/api/file",Or),$n.use("/api/globalsearch",vn),$n.use("/api/versioncontrol",Nn),$n.use("/api/notification",Dn),$n.use("/webhook",Rn),$n.get("/documents/count/category",function(){var t=zn(Vn().mark((function t(e,r){var n,o;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.query("SELECT c.id, c.category, c.color, c.svg, COUNT(d.id) AS total_documents\n      FROM category c\n      LEFT JOIN document d ON c.id = d.category_id\n      where d.is_active = TRUE\n      GROUP BY c.id, c.category,c.color,c.svg UNION\n\nSELECT \n    NULL,'Total',NULL,NULL,\n    COUNT(*) AS total_documents\nFROM \n    document where document.is_active =TRUE\n    \n    Order BY total_documents DESC;");case 3:n=t.sent,o=n.rows,r.json(o),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getversions/datewise",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.docId),t.prev=1,t.next=4,a.query("SELECT \n      datew,\n      STRING_AGG(grouped_value, ', ') AS grouped_values\n  FROM (\n      SELECT \n          dv.created_at,\n          DATE(dv.created_at) as datew,\n          '[' || dv.id::text || ',' || dv.version_number || ',' || dv.doc_id ||  ',' || dv.created_at || ',' || u.first_name || ']' AS grouped_value\n      FROM \n          document_version dv\n      JOIN \n          user_table u ON dv.created_by = u.id\n      WHERE \n          dv.doc_id = $1\n      ORDER BY \n          dv.created_at DESC\n  ) subquery\n  GROUP BY \n      datew\n  ORDER BY \n      datew DESC;\n  \n  ",[n]);case 4:o=t.sent,i=o.rows,r.json(i),console.log(i),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/letters/getversions/datewise",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.docId),t.prev=1,t.next=4,a.query("SELECT \n      datew,\n      STRING_AGG(grouped_value, ', ') AS grouped_values\n  FROM (\n      SELECT \n          dv.created_at,\n          DATE(dv.created_at) as datew,\n          '[' || dv.id::text || ',' || dv.version_number || ',' || dv.doc_id ||  ',' || dv.created_at || ',' || u.first_name || ']' AS grouped_value\n      FROM \n          template_version dv\n      JOIN \n          user_table u ON dv.created_by = u.id\n      WHERE \n          dv.doc_id = $1\n      ORDER BY \n          dv.created_at DESC\n  ) subquery\n  GROUP BY \n      datew\n  ORDER BY \n      datew DESC;\n  \n  ",[n]);case 4:o=t.sent,i=o.rows,r.json(i),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getVersionbyID",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),t.prev=1,t.next=4,a.query("SELECT * from document_version where id=$1;",[n]);case 4:o=t.sent,i=o.rows,r.json(i),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getVersionbyIDTemplate",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),t.prev=1,t.next=4,a.query("SELECT * from template_version where id=$1;",[n]);case 4:o=t.sent,i=o.rows,r.json(i),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getLatestVersionbyDocIdandUserId",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),o=parseInt(e.query.user),t.prev=2,t.next=5,a.query("SELECT * from document_version where doc_id=$1 and created_by=$2 ORDER BY created_at DESC LIMIT 1",[n,o]);case 5:i=t.sent,c=i.rows,r.json(c),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getPolicyApprovalsByUserId",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),t.prev=1,t.next=4,a.query("SELECT \n      d.id, \n      ar.id,\n      d.title, \n      ar.status,\n      ar.doc_id,\n      ar.reason,\n      ar.request_to,\n      ar.request_by,\n     \n      u2.first_name AS sent_by_first_name, \n      u2.last_name AS sent_by_last_name\n  FROM \n      approval_request ar\n  \n  JOIN \n      user_table u2 ON ar.request_by = u2.id\n   JOIN document d ON ar.doc_id  = d.id\n  WHERE \n      ar.request_to = $1 and ar.status = 'VIEW'; ",[n]);case 4:o=t.sent,i=o.rows,r.json(i),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/deleteTemplate",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),t.prev=1,t.next=4,a.query("DELETE FROM template WHERE id = $1",[n]);case 4:o=t.sent,i=o.rows,r.json(i),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getPolicyApprovalsUserSent",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),t.prev=1,t.next=4,a.query("SELECT \n      d.id, \n      ar.id,\n      d.title, \n      ar.status,\n      ar.doc_id,\n      ar.reason,\n      ar.request_to,\n      ar.request_by,\n     \n      u2.first_name AS sent_by_first_name, \n      u2.last_name AS sent_by_last_name\n  FROM \n      approval_request ar\n  \n  JOIN \n      user_table u2 ON ar.request_to = u2.id\n   JOIN document d ON ar.doc_id  = d.id\n  WHERE \n      ar.request_by = $1 and ar.status != 'APPROVED';",[n]);case 4:o=t.sent,i=o.rows,r.json(i),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.post("/api/setDocumentToApprove",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c,s,u;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.body),n=e.body,o=n.admin_id,i=n.doc_id,c=n.user_id,s=[parseInt(o),parseInt(c),parseInt(i)],t.prev=4,t.next=7,a.query("\n  INSERT INTO approval_request(request_to, request_by,doc_id) VALUES($1,$2,$3) RETURNING *\n",s);case 7:return u=t.sent,t.next=10,mr("303",i,ir,o,c);case 10:return console.log(u),t.abrupt("return",r.status(201).json({success:!0,message:"Document TO APPROVED SET"}));case 14:throw t.prev=14,t.t0=t.catch(4),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 18:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.post("/api/rejectPolicyApproval",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c,s,u,l,p,f;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body,o=n.id,i=n.reason,console.log(o,i),c=[parseInt(o),i],t.prev=4,t.next=7,a.query("\n  UPDATE approval_request SET status = 'REJECTED' , reason=$2 where id =$1 RETURNING *\n",c);case 7:return u=t.sent,console.log(u),l=u.rows[0].doc_id,p=u.rows[0].request_to,f=null==u||null===(s=u.rows[0])||void 0===s?void 0:s.request_by,t.next=14,mr("302",l,ir,f,p);case 14:return t.abrupt("return",r.status(201).json({success:!0,message:"Document TO APPROVED SET"}));case 17:throw t.prev=17,t.t0=t.catch(4),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 21:case"end":return t.stop()}}),t,null,[[4,17]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/api/approvePolicyApproval",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c,s,u,l;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),o=[parseInt(n)],t.prev=3,t.next=6,a.query("UPDATE approval_request SET status = 'APPROVED' where id =$1 RETURNING *",o);case 6:return s=t.sent,u=null==s||null===(i=s.rows[0])||void 0===i?void 0:i.doc_id,l=null==s||null===(c=s.rows[0])||void 0===c?void 0:c.request_to,console.log(u,"Dco id is"),t.next=13,mr("301",u,ir,0,l,1);case 13:return t.abrupt("return",r.status(201).json({success:!0,message:"Policy Request Approved"}));case 16:throw t.prev=16,t.t0=t.catch(3),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 20:case"end":return t.stop()}}),t,null,[[3,16]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/api/activepolicy",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c,s,u;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),o=parseInt(e.query.actor_id),i=[parseInt(n)],t.prev=4,t.next=7,a.query("UPDATE document SET is_active = TRUE where id =$1 RETURNING *",i);case 7:return s=t.sent,u=null==s||null===(c=s.rows[0])||void 0===c?void 0:c.id,console.log(u,"Dco id is"),t.next=13,mr("606",u,ir,0,o,1);case 13:return t.abrupt("return",r.status(201).json({success:!0,message:"Policy gets activated"}));case 16:throw t.prev=16,t.t0=t.catch(4),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 20:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/api/deactivatepolicy",function(){var t=zn(Vn().mark((function t(e,r){var n,o;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=parseInt(e.query.id),parseInt(e.query.actor_id),o=[parseInt(n)],t.prev=4,t.next=7,a.query("UPDATE document SET is_active = FALSE where id =$1 RETURNING *",o);case 7:return t.sent,t.abrupt("return",r.status(201).json({success:!0,message:"Policy gets deactivated"}));case 11:throw t.prev=11,t.t0=t.catch(4),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 15:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.post("/api/updatePolicyHtmlData",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c,s,u,l,p;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body,o=n.id,i=n.htmldata,c=n.htmlJson,console.log(o),s=[i,c,parseInt(o)],u="\n  DELETE FROM document_version WHERE doc_id=$1;\n",l=[parseInt(o)],t.prev=6,t.next=9,a.query("\n  UPDATE document SET htmldata=$1, htmljson=$2  WHERE id=$3 RETURNING *\n",s);case 9:return p=t.sent,t.next=12,a.query(u,l);case 12:return t.sent,console.log(p),t.abrupt("return",r.status(201).json({success:!0,message:"Policy Request Approved"}));case 17:throw t.prev=17,t.t0=t.catch(6),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 21:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.post("/api/updateTemplateHtmlData",function(){var t=zn(Vn().mark((function t(e,r){var n,o,i,c,s,u,l,p;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body,o=n.id,i=n.htmldata,c=n.htmlJson,console.log(o),s=[i,c,parseInt(o)],u="\n  DELETE FROM template_version WHERE doc_id=$1;\n",l=[parseInt(o)],t.prev=6,t.next=9,a.query("\n  UPDATE template SET htmldata=$1, htmljson=$2  WHERE id=$3 RETURNING *\n",s);case 9:return p=t.sent,t.next=12,a.query(u,l);case 12:return t.sent,console.log(p),t.abrupt("return",r.status(201).json({success:!0,message:"Template Request Approved"}));case 17:throw t.prev=17,t.t0=t.catch(6),console.log(t.t0.message,"rg"),new x("cant set to_approve field");case 21:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.get("/getAdminList",function(){var t=zn(Vn().mark((function t(e,r){var n,o;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.query("SELECT * from user_table where group_id = 2;");case 3:n=t.sent,o=n.rows,r.json(o),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error executing query",t.t0),r.status(500).json({error:"Internal server error"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r){return t.apply(this,arguments)}}()),$n.use((function(t,e,r,n){var o=t.statusCode,a=t.message,i=t.error,c=t.success;return console.log(t),r.status(o).send({statusCode:o,message:a,success:c,error:i})}));var Zn=process.env.PORT||3e3;$n.listen(Zn,(function(){console.log("server statrted at "+Zn)}))})();